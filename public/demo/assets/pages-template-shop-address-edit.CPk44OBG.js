import{_ as e}from"./cl-input.Db_a5q7W.js";import{d as l,r as a,t,a as s,o,c as u,w as r,I as c,O as d,e as n,i,u as p,p as m,f,g as O,H as b,a8 as v,q as S,a7 as j,_ as h}from"./index-CQm_J2yh.js";import{o as w,r as _,d as g,b as U,u as T}from"./cl-page.uvue_vue_type_script_setup_true_lang.CluByn4i.js";import{_ as N,a as J}from"./cl-form.BaOJ5XHE.js";import{p as V,_ as y}from"./pca.DoJTolsW.js";import{_ as q}from"./cl-switch.DZLZNJjY.js";import{_ as x}from"./cl-list-item.BP2K226D.js";import{_ as k}from"./cl-list.Ck4jDciA.js";import{_ as D}from"./cl-footer.CaFcSWZv.js";import{u as C}from"./component.CXP6yD-I.js";import{u as L}from"./form.DjIMDBgs.js";import"./cl-select-trigger.1oGFq4Uw.js";import"./cl-tag.iiVipK_K.js";import"./cl-list-view.B71BtSPO.js";import"./cl-empty.CZBvZ2IL.js";import"./index.U6ITPUe7.js";import"./cl-collapse.BiDwmPWZ.js";const R=l({__name:"address-edit",props:{id:{type:String,default:""}},setup(l){const R=l,z=T(),E=L(),F=E.formRef,H=E.validate,I=C(V),M=a([]),P=a({contact:"",phone:"",province:"",city:"",district:"",address:"",isDefault:!1}),$=new Map([["contact",[{required:!0,message:t("收货人不能为空")}]],["phone",[{required:!0,message:t("手机号不能为空")},{pattern:/^1[3-9]\d{9}$/,message:t("手机号格式不正确")}]],["address",[{required:!0,message:t("详细地址不能为空")}]],["province",[{required:!0,message:t("所在地区不能为空")}]]]),A=a(!1);function B(e){const l=v(j(e)?["","",""]:e,3),a=l[0],t=l[1],s=l[2];P.value.province=a,P.value.city=t,P.value.district=s}return w((()=>{""!=R.id&&c({url:"/app/user/address/info",data:new UTSJSONObject({id:R.id})}).then(((e=null)=>{null!=e&&(P.value=d(e),M.value=[P.value.province,P.value.city,P.value.district])})).catch(((e=null)=>{z.showToast({message:e.message})}))})),(l=null,a=null)=>{const d=_(s("cl-input"),e),j=_(s("cl-form-item"),N),w=_(s("cl-cascader"),y),T=_(s("cl-form"),J),V=h,C=_(s("cl-switch"),q),L=_(s("cl-list-item"),x),E=_(s("cl-list"),k),G=_(s("cl-button"),g),K=_(s("cl-footer"),D),Q=_(s("cl-page"),U);return o(),u(Q,null,new UTSJSONObject({default:r((()=>[n(V,new UTSJSONObject({class:"p-3"}),{default:r((()=>[n(V,new UTSJSONObject({class:i(["p-4 bg-white rounded-2xl mb-3",new UTSJSONObject({"dark-colon--important-bg-surface-800":p(m)})])}),{default:r((()=>[n(T,new UTSJSONObject({ref_key:"formRef",ref:F,modelValue:P.value,"onUpdate:modelValue":a[4]||(a[4]=(e=null)=>P.value=e),rules:p($),disabled:A.value}),{default:r((()=>[n(j,new UTSJSONObject({label:p(t)("收货人"),prop:"contact",required:""}),{default:r((()=>[n(d,new UTSJSONObject({modelValue:P.value.contact,"onUpdate:modelValue":a[0]||(a[0]=(e=null)=>P.value.contact=e),placeholder:p(t)("请输入收货人姓名")}),null,8,["modelValue","placeholder"])])),_:1},8,["label"]),n(j,new UTSJSONObject({label:p(t)("手机号"),prop:"phone",required:""}),{default:r((()=>[n(d,new UTSJSONObject({modelValue:P.value.phone,"onUpdate:modelValue":a[1]||(a[1]=(e=null)=>P.value.phone=e),placeholder:p(t)("请输入手机号"),maxlength:11,type:"number"}),null,8,["modelValue","placeholder"])])),_:1},8,["label"]),n(j,new UTSJSONObject({label:p(t)("地区"),prop:"province",required:""}),{default:r((()=>[n(w,new UTSJSONObject({modelValue:M.value,"onUpdate:modelValue":a[2]||(a[2]=(e=null)=>M.value=e),placeholder:p(t)("选择省市区"),options:p(I),onChange:B}),null,8,["modelValue","placeholder","options"])])),_:1},8,["label"]),n(j,new UTSJSONObject({label:p(t)("详细地址"),prop:"address",required:""}),{default:r((()=>[n(d,new UTSJSONObject({modelValue:P.value.address,"onUpdate:modelValue":a[3]||(a[3]=(e=null)=>P.value.address=e),placeholder:p(t)("小区楼栋、门牌号、村等")}),null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1},8,["modelValue","rules","disabled"])])),_:1},8,["class"]),n(E,null,{default:r((()=>[n(L,new UTSJSONObject({label:p(t)("默认地址")}),{default:r((()=>[n(C,new UTSJSONObject({modelValue:P.value.isDefault,"onUpdate:modelValue":a[5]||(a[5]=(e=null)=>P.value.isDefault=e)}),null,8,["modelValue"])])),_:1},8,["label"])])),_:1})])),_:1}),n(K,null,{default:r((()=>[n(G,new UTSJSONObject({onClick:a[6]||(a[6]=(e=null)=>function(){H(((e,l)=>b(this,void 0,void 0,(function*(){if(e){z.showLoading(t("保存中"));const e=v(M.value,3),l=e[0],a=e[1],s=e[2];A.value=!0;const o=new UTSJSONObject(Object.assign(Object.assign({},P.value),{province:l,city:a,district:s}));c({url:"/app/user/address/".concat(""!=R.id?"update":"add"),method:"POST",data:o}).then((()=>{S.back()})).catch(((e=null)=>{z.showToast({message:e.message})})).finally((()=>{z.hideLoading(),A.value=!1}))}else z.showToast({message:l[0].message})}))))}())}),{default:r((()=>[f(O(p(t)("保存")),1)])),_:1})])),_:1})])),_:1}))}}});export{R as default};
