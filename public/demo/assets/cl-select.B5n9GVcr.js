import{_ as e}from"./cl-select-trigger.SpARLyEx.js";import{d as l,t,z as a,c as n,T as u,r as o,o as r,j as s,a as p,q as c,b as i,w as d,F as v,W as m,a0 as f,O as g,f as _,g as S,_ as h}from"./index-Dq8L0aBz.js";import{r as T,d as y,e as O,c as b}from"./cl-page.uvue_vue_type_script_setup_true_lang.zroYvlZE.js";import{_ as w}from"./cl-picker-view.ybp6Np24.js";class U extends UTS.UTSType{static get$UTSMetadata$(){return{kind:2,get fields(){return{trigger:{type:"Unknown",optional:!0},popup:{type:"Unknown",optional:!0}}}}}constructor(e,l=U.get$UTSMetadata$(),t=!1){super(),this.__props__=UTS.UTSType.initProps(e,l,t),this.trigger=this.__props__.trigger,this.popup=this.__props__.popup,delete this.__props__}}const j=b(l(Object.assign({name:"cl-select"},{__name:"cl-select",props:{pt:{type:Object,default:()=>new UTSJSONObject({})},modelValue:{type:[Array,Number,String],default:null},title:{type:String,default:()=>t("请选择")},placeholder:{type:String,default:()=>t("请选择")},options:{type:Array,default:()=>[]},showTrigger:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},columnCount:{type:Number,default:1},splitor:{type:String,default:" - "},confirmText:{type:String,default:()=>t("确定")},showConfirm:{type:Boolean,default:!0},cancelText:{type:String,default:()=>t("取消")},showCancel:{type:Boolean,default:!0}},emits:["update:modelValue","change"],setup(l,t){var b=t.expose,U=t.emit;const j=l,N=U,x=a(null),k=n((()=>m(j.pt))),C=a([]),J=a([]),V=n((()=>{let e=j.options,l=[];for(let t=0;t<j.columnCount;t++){const a=[...e],n=t>=C.value.length?null:C.value[t];let u=UTS.arrayFind(e,(e=>e.value==n));null!=u||f(e)||(u=e[0]),null!=(null==u?null:u.children)&&(e=u.children),l.push(a)}return l})),A=n((()=>{const e=j.modelValue;if(null==e||f(e))return"";let l;return l=1==j.columnCount?[e]:e,l.map(((e=null,l)=>{var t,a;return null!==(a=null===(t=UTS.arrayFind(V.value[l],(l=>l.value==e)))||void 0===t?null:t.label)&&void 0!==a?a:""})).join(j.splitor)}));function B(e){const l=[...J.value];let t=!1;for(let a=0;a<e.length;a++)t?l[a]=0:l[a]!=e[a]&&(l[a]=e[a],t=!0);J.value=l,C.value=l.map(((e,l)=>V.value[l][e].value))}const $=a(!1);let z=null;function F(e=null){$.value=!0,z=e}function I(){$.value=!1}function M(){1==j.columnCount?(N("update:modelValue",null),N("change",null)):(N("update:modelValue",[]),N("change",[]))}function q(){const e=1==j.columnCount?C.value[0]:C.value;N("update:modelValue",e),N("change",e),null!=z&&z(e),I()}return u(n((()=>j.modelValue)),((e=null)=>{let l;l=null==e?[]:Array.isArray(e)?[...e]:[e];let t=[];for(let a=0;a<j.columnCount;a++)if(a>=l.length)t.push(0),l.push(V.value[a][0].value);else{let e=V.value[a].findIndex((e=>e.value==l[a]));e<0&&(e=0),t.push(e)}C.value=l,J.value=t}),{immediate:!0}),b(new UTSJSONObject({open:F,close:I})),(t=null,a=null)=>{var n,u,m,f,b,U,j,N;const C=T(o("cl-select-trigger"),e),z=T(o("cl-picker-view"),w),P=h,R=T(o("cl-button"),y),W=T(o("cl-popup"),O);return r(),s(v,null,[l.showTrigger?(r(),p(C,{key:0,pt:{className:null===(n=k.value.trigger)||void 0===n?null:n.className,icon:null===(u=k.value.trigger)||void 0===u?null:u.icon},placeholder:l.placeholder,disabled:l.disabled,focus:null===(m=x.value)||void 0===m?null:m.isOpen,text:A.value,onOpen:a[0]||(a[0]=(e=null)=>F()),onClear:M},null,8,["pt","placeholder","disabled","focus","text"])):c("",!0),i(W,{ref_key:"popupRef",ref:x,modelValue:$.value,"onUpdate:modelValue":a[2]||(a[2]=(e=null)=>$.value=e),title:l.title,pt:{className:null===(f=k.value.popup)||void 0===f?null:f.className,header:null===(b=k.value.popup)||void 0===b?null:b.header,container:null===(U=k.value.popup)||void 0===U?null:U.container,mask:null===(j=k.value.popup)||void 0===j?null:j.mask,draw:null===(N=k.value.popup)||void 0===N?null:N.draw}},{default:d((()=>[i(P,new UTSJSONObject({class:"cl-select-popup",onTouchmove:a[1]||(a[1]=g((()=>{}),["stop"]))}),{default:d((()=>[i(P,new UTSJSONObject({class:"cl-select-popup__picker"}),{default:d((()=>[i(z,new UTSJSONObject({value:J.value,columns:V.value,onChangeIndex:B}),null,8,["value","columns"])])),_:1}),i(P,new UTSJSONObject({class:"cl-select-popup__op"}),{default:d((()=>[l.showCancel?(r(),p(R,new UTSJSONObject({key:0,size:"large",text:"",border:"",type:"light",pt:new UTSJSONObject({className:"flex-1 -important-rounded-xl h--bracket-start-80rpx-bracket-end-"}),onClick:I}),new UTSJSONObject({default:d((()=>[_(S(l.cancelText),1)])),_:1}))):c("",!0),l.showConfirm?(r(),p(R,new UTSJSONObject({key:1,size:"large",pt:new UTSJSONObject({className:"flex-1 -important-rounded-xl h--bracket-start-80rpx-bracket-end-"}),onClick:q}),new UTSJSONObject({default:d((()=>[_(S(l.confirmText),1)])),_:1}))):c("",!0)])),_:1})])),_:1})])),_:1},8,["modelValue","title","pt"])],64)}}})),[["__scopeId","data-v-7c057dfe"]]);export{j as _};
