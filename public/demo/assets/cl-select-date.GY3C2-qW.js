import{_ as e}from"./cl-select-trigger.SpARLyEx.js";import{d as a,t,z as l,c as u,T as n,r,o as s,j as o,a as c,q as p,b as d,w as i,F as v,W as S,P as f,a0 as m,ab as g,Z as b,O,k as h,f as _,g as y,n as w,u as T,e as j,E as N,_ as U}from"./index-Dq8L0aBz.js";import{f as J,u as k,r as x,a as Y,d as C,e as A,c as V}from"./cl-page.uvue_vue_type_script_setup_true_lang.zroYvlZE.js";import{_ as F}from"./cl-tag.-w1cDlIg.js";import{_ as M}from"./cl-picker-view.ybp6Np24.js";import{d as B}from"./day.C6z4Qky5.js";class D extends UTS.UTSType{static get$UTSMetadata$(){return{kind:2,get fields(){return{trigger:{type:"Unknown",optional:!0},popup:{type:"Unknown",optional:!0}}}}}constructor(e,a=D.get$UTSMetadata$(),t=!1){super(),this.__props__=UTS.UTSType.initProps(e,a,t),this.trigger=this.__props__.trigger,this.popup=this.__props__.popup,delete this.__props__}}const P=V(a(Object.assign({name:"cl-select-date"},{__name:"cl-select-date",props:{pt:{type:Object,default:()=>new UTSJSONObject({})},modelValue:{type:String,default:""},values:{type:Array,default:()=>[]},headers:{type:Array,default:()=>[t("年"),t("月"),t("日"),t("时"),t("分"),t("秒")]},title:{type:String,default:()=>t("请选择")},placeholder:{type:String,default:()=>t("请选择")},showTrigger:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},confirmText:{type:String,default:()=>t("确定")},showConfirm:{type:Boolean,default:!0},cancelText:{type:String,default:()=>t("取消")},showCancel:{type:Boolean,default:!0},labelFormat:{type:String,default:""},valueFormat:{type:String,default:""},start:{type:String,default:J.startDate},end:{type:String,default:J.endDate},type:{type:String,default:"second"},rangeable:{type:Boolean,default:!1},startPlaceholder:{type:String,default:()=>t("开始日期")},endPlaceholder:{type:String,default:()=>t("结束日期")},rangeSeparator:{type:String,default:()=>t("至")},showShortcuts:{type:Boolean,default:!0},shortcuts:{type:Array,default:()=>[]}},emits:["update:modelValue","change","update:values","range-change"],setup(a,J){var V=J.expose,D=J.emit;const P=a,$=D,z=k(),I=l(null),E=u((()=>S(P.pt))),H=u((()=>{switch(P.type){case"year":return"YYYY";case"month":return"YYYY-MM";case"date":return"YYYY-MM-DD";default:return"YYYY-MM-DD HH:mm:ss"}})),R=u((()=>f(P.labelFormat)||m(P.labelFormat)?H.value:P.labelFormat)),q=u((()=>f(P.valueFormat)||m(P.valueFormat)?H.value:P.valueFormat)),W=l(-1),Z=u((()=>m(P.shortcuts)?[{label:t("今天"),value:[B().format(q.value),B().format(q.value)]},{label:t("近7天"),value:[B().subtract(7,"day").format(q.value),B().format(q.value)]},{label:t("近30天"),value:[B().subtract(30,"day").format(q.value),B().format(q.value)]},{label:t("近90天"),value:[B().subtract(90,"day").format(q.value),B().format(q.value)]},{label:t("近一年"),value:[B().subtract(1,"year").format(q.value),B().format(q.value)]}]:P.shortcuts)),G=l(0),K=l(["",""]),L=l([]),Q=u((()=>P.rangeable?0==G.value?P.start:K.value[0]:P.start)),X=u((()=>{const e=g(B(Q.value).toArray(),6),a=e[0],t=e[1],l=e[2],u=e[3],n=e[4],r=e[5],s=g(B(P.end).toArray(),6),o=s[0],c=s[1],p=s[2],d=s[3],i=s[4],v=s[5],S=[[],[],[],[],[],[]];if(m(L.value))return S;const f=g(L.value,5),b=f[0],O=f[1],h=f[2],_=f[3],y=f[4],w=[31,b%4==0&&b%100!=0||b%400==0?29:28,31,30,31,30,31,31,30,31,30,31][O>0?O-1:0],T=Math.max(60,o-a+1);for(let m=0;m<T;m++){const e=a+m;e<=o&&S[0].push({label:e.toString(),value:e});let s=a==b?t+m:m+1;s<=(o==b?c:12)&&S[1].push({label:s.toString().padStart(2,"0"),value:s});let f=a==b&&t==O?l+m:m+1;f<=(o==b&&c==O?p:w)&&S[2].push({label:f.toString().padStart(2,"0"),value:f});let g=a==b&&t==O&&l==h?u+m:m;g<(o==b&&c==O&&p==h?d:24)&&S[3].push({label:g.toString().padStart(2,"0"),value:g});let T=a==b&&t==O&&l==h&&u==_?n+m:m;T<(o==b&&c==O&&p==h&&d==_?i:60)&&S[4].push({label:T.toString().padStart(2,"0"),value:T});let j=a==b&&t==O&&l==h&&u==_&&n==y?r+m:m;j<(o==b&&c==O&&p==h&&d==_&&i==y?v:60)&&S[5].push({label:j.toString().padStart(2,"0"),value:j})}return S})),ee=u((()=>["year","month","date","hour","minute","second"].findIndex((e=>e==P.type))+1)),ae=u((()=>X.value.slice(0,ee.value))),te=u((()=>m(L.value)?[]:L.value.map(((e,a)=>{let t=X.value[a].findIndex((a=>a.value==e));return-1==t&&(t=X.value[a].length-1),t<0&&(t=0),t}))));function le(){const e=[],a=[2e3,1,1,0,0,0];return["","-","-"," ",":",":"].forEach(((t,l)=>{let u=L.value[l];l>=ee.value&&(u=a[l]),e.push(t+u.toString().padStart(2,"0"))})),e.join("")}function ue(e){if(0==e.length)return e;const a=[...e],t=[2e3,1,1,0,0,0];for(let d=a.length;d<6;d++)a.push(t[d]);let l=g(a,6),u=l[0],n=l[1],r=l[2],s=l[3],o=l[4],c=l[5];const p=[31,u%4==0&&u%100!=0||u%400==0?29:28,31,30,31,30,31,31,30,31,30,31][n-1];return r<1?r=1:r>p&&(r=p),s<0?s=0:s>23&&(s=23),o<0?o=0:o>59&&(o=59),c<0?c=0:c>59&&(c=59),[u,n,r,s,o,c]}const ne=l("");function re(){P.rangeable?ne.value=K.value.map((e=>B(e).format(R.value))).join(" ".concat(P.rangeSeparator," ")):ne.value=B(le()).format(R.value)}function se(e){return N(this,void 0,void 0,(function*(){L.value=ue(e),B(le()).isAfter(B(P.end))&&(L.value=B(P.end).toArray()),B(le()).isBefore(B(P.start))&&(L.value=B(P.start).toArray()),P.rangeable&&(K.value[G.value]=B(le()).format(q.value),B(K.value[0]).isAfter(B(K.value[1]))&&""!=K.value[1]&&(K.value[1]=K.value[0]),W.value=-1)}))}function oe(e){ne.value="",f(e)||m(e)?L.value=ue(B().toArray()):(L.value=ue(B(e).toArray()),re())}function ce(e){m(e)?K.value=["",""]:K.value=e}function pe(e){G.value=e,oe(K.value[e])}const de=l(!1);let ie=null;function ve(e=null){if(P.disabled)return null;de.value=!0,ie=e,b((()=>{P.rangeable?(G.value=0,ce(P.values),oe(K.value[0])):oe(P.modelValue)}))}function Se(){de.value=!1}function fe(){K.value=["",""]}function me(){ne.value="",P.rangeable?($("update:values",[]),$("range-change",[])):($("update:modelValue",""),$("change",""))}function ge(){if(P.rangeable){const e=g(K.value,2),a=e[0],l=e[1];if(""==a||""==l)return z.showToast({message:t("请选择完整时间范围")}),""!=a&&(G.value=1),null;if(B(a).isAfter(B(l)))return z.showToast({message:t("开始日期不能大于结束日期")}),null;$("update:values",K.value),$("range-change",K.value),null!=ie&&ie(K.value)}else{const e=B(le()).format(q.value);$("update:modelValue",e),$("change",e),null!=ie&&ie(e)}re(),Se()}return n(u((()=>P.modelValue)),(e=>{oe(e)}),{immediate:!0}),n(u((()=>P.values)),(e=>{ce(e)}),{immediate:!0}),n(u((()=>P.labelFormat)),(()=>{re()})),V(new UTSJSONObject({open:ve,close:Se,clear:me,confirm:ge,setValue:oe,setValues:ce,setRange:pe})),(t=null,l=null)=>{var u,n,S,f,m,g,b,N;const J=x(r("cl-select-trigger"),e),k=x(r("cl-tag"),F),V=U,B=x(r("cl-text"),Y),D=x(r("cl-picker-view"),M),P=x(r("cl-button"),C),$=x(r("cl-popup"),A);return s(),o(v,null,[a.showTrigger?(s(),c(J,{key:0,pt:{className:null===(u=E.value.trigger)||void 0===u?null:u.className,icon:null===(n=E.value.trigger)||void 0===n?null:n.icon},placeholder:a.placeholder,disabled:a.disabled,focus:null===(S=I.value)||void 0===S?null:S.isOpen,text:ne.value,"arrow-icon":"calendar-line",onOpen:l[0]||(l[0]=(e=null)=>ve()),onClear:me},null,8,["pt","placeholder","disabled","focus","text"])):p("",!0),d($,{ref_key:"popupRef",ref:I,modelValue:de.value,"onUpdate:modelValue":l[4]||(l[4]=(e=null)=>de.value=e),title:a.title,pt:{className:null===(f=E.value.popup)||void 0===f?null:f.className,header:null===(m=E.value.popup)||void 0===m?null:m.header,container:null===(g=E.value.popup)||void 0===g?null:g.container,mask:null===(b=E.value.popup)||void 0===b?null:b.mask,draw:null===(N=E.value.popup)||void 0===N?null:N.draw},onClosed:fe},{default:i((()=>[d(V,new UTSJSONObject({class:"cl-select-popup",onTouchmove:l[3]||(l[3]=O((()=>{}),["stop"]))}),{default:i((()=>[a.rangeable?(s(),c(V,new UTSJSONObject({key:0,class:"cl-select-popup__range"}),new UTSJSONObject({default:i((()=>[a.showShortcuts?(s(),c(V,new UTSJSONObject({key:0,class:"cl-select-popup__range-shortcuts"}),new UTSJSONObject({default:i((()=>[(s(!0),o(v,null,h(Z.value,((e,a)=>(s(),c(k,new UTSJSONObject({key:a,plain:"",type:W.value==a?"primary":"info",onClick:(t=null)=>function(e,a){W.value=a,K.value=[...e],oe(e[G.value])}(e.value,a)}),new UTSJSONObject({default:i((()=>[_(y(e.label),1)])),_:2}),1032,["type","onClick"])))),128))])),_:1}))):p("",!0),d(V,new UTSJSONObject({class:"cl-select-popup__range-values"}),{default:i((()=>[d(V,new UTSJSONObject({class:w(["cl-select-popup__range-values-start",new UTSJSONObject({"is-dark":T(j),active:0==G.value})]),onClick:l[1]||(l[1]=(e=null)=>pe(0))}),{default:i((()=>[K.value.length>0&&""!=K.value[0]?(s(),c(B,new UTSJSONObject({key:0,pt:new UTSJSONObject({className:"text-center"})}),new UTSJSONObject({default:i((()=>[_(y(K.value[0]),1)])),_:1}))):(s(),c(B,new UTSJSONObject({key:1,pt:new UTSJSONObject({className:"text-center -important-text-surface-400"})}),new UTSJSONObject({default:i((()=>[_(y(a.startPlaceholder),1)])),_:1})))])),_:1},8,["class"]),d(B,new UTSJSONObject({pt:new UTSJSONObject({className:"mx-3"})}),{default:i((()=>[_(y(a.rangeSeparator),1)])),_:1}),d(V,new UTSJSONObject({class:w(["cl-select-popup__range-values-end",new UTSJSONObject({"is-dark":T(j),active:1==G.value})]),onClick:l[2]||(l[2]=(e=null)=>pe(1))}),{default:i((()=>[K.value.length>1&&""!=K.value[1]?(s(),c(B,new UTSJSONObject({key:0,pt:new UTSJSONObject({className:"text-center"})}),new UTSJSONObject({default:i((()=>[_(y(K.value[1]),1)])),_:1}))):(s(),c(B,new UTSJSONObject({key:1,pt:new UTSJSONObject({className:"text-center -important-text-surface-400"})}),new UTSJSONObject({default:i((()=>[_(y(a.endPlaceholder),1)])),_:1})))])),_:1},8,["class"])])),_:1})])),_:1}))):p("",!0),d(V,new UTSJSONObject({class:"cl-select-popup__picker"}),{default:i((()=>[d(D,new UTSJSONObject({headers:a.headers,value:te.value,columns:ae.value,"reset-on-change":!1,onChangeValue:se}),null,8,["headers","value","columns"])])),_:1}),d(V,new UTSJSONObject({class:"cl-select-popup__op"}),{default:i((()=>[a.showCancel?(s(),c(P,new UTSJSONObject({key:0,size:"large",text:"",border:"",type:"light",pt:new UTSJSONObject({className:"flex-1 -important-rounded-xl h--bracket-start-80rpx-bracket-end-"}),onClick:Se}),new UTSJSONObject({default:i((()=>[_(y(a.cancelText),1)])),_:1}))):p("",!0),a.showConfirm?(s(),c(P,new UTSJSONObject({key:1,size:"large",pt:new UTSJSONObject({className:"flex-1 -important-rounded-xl h--bracket-start-80rpx-bracket-end-"}),onClick:ge}),new UTSJSONObject({default:i((()=>[_(y(a.confirmText),1)])),_:1}))):p("",!0)])),_:1})])),_:1})])),_:1},8,["modelValue","title","pt"])],64)}}})),[["__scopeId","data-v-4eaed463"]]);export{P as _};
