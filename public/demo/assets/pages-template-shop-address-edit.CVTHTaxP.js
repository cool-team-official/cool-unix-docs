import{_ as e}from"./cl-input.tsrNEnDP.js";import{d as l,r as a,t as s,a as t,o,c as u,w as r,I as n,O as c,e as d,i,u as p,p as m,f,g as O,H as b,a8 as v,q as S,a7 as j,_ as h}from"./index-CNagV5B9.js";import{o as w,r as _,d as g,b as U,u as T}from"./cl-page.uvue_vue_type_script_setup_true_lang.Dujw6vu5.js";import{_ as J,a as N}from"./cl-form.8DydYZ7j.js";import{p as V,_ as y}from"./pca.B2VLYFjF.js";import{_ as q}from"./cl-switch.CYfHNfMX.js";import{_ as x}from"./cl-list-item.D9Fwhzfd.js";import{_ as k}from"./cl-list.DqrUvrrm.js";import{_ as D}from"./cl-footer.T69JFkIC.js";import{u as C}from"./component.C_1pcFTG.js";import{u as L}from"./form.psaMSS8r.js";import"./cl-select-trigger.DF-0QJ7I.js";import"./cl-tag.2VZc8Gp8.js";import"./cl-list-view.CWEOrQUF.js";import"./cl-empty.CDnmE2uK.js";import"./index.U6ITPUe7.js";import"./cl-collapse.S3OdLei1.js";const R=l({__name:"address-edit",props:{id:{type:String,default:""}},setup(l){const R=l,z=T(),A=L(),E=A.formRef,F=A.validate,G=C(V),H=a([]),I=a({contact:"",phone:"",province:"",city:"",district:"",address:"",isDefault:!1}),M=new Map([["contact",[{required:!0,message:s("收货人不能为空")}]],["phone",[{required:!0,message:s("手机号不能为空")},{pattern:/^1[3-9]\d{9}$/,message:s("手机号格式不正确")}]],["address",[{required:!0,message:s("详细地址不能为空")}]],["province",[{required:!0,message:s("所在地区不能为空")}]]]),P=a(!1);function $(e){const l=v(j(e)?["","",""]:e,3),a=l[0],s=l[1],t=l[2];I.value.province=a,I.value.city=s,I.value.district=t}return w((()=>{""!=R.id&&n({url:"/app/user/address/info",data:new UTSJSONObject({id:R.id})}).then(((e=null)=>{null!=e&&(I.value=c(e),H.value=[I.value.province,I.value.city,I.value.district])})).catch(((e=null)=>{z.showToast({message:e.message})}))})),(l=null,a=null)=>{const c=_(t("cl-input"),e),j=_(t("cl-form-item"),J),w=_(t("cl-cascader"),y),T=_(t("cl-form"),N),V=h,C=_(t("cl-switch"),q),L=_(t("cl-list-item"),x),A=_(t("cl-list"),k),B=_(t("cl-button"),g),K=_(t("cl-footer"),D),Q=_(t("cl-page"),U);return o(),u(Q,null,new UTSJSONObject({default:r((()=>[d(V,new UTSJSONObject({class:"p-3"}),{default:r((()=>[d(V,new UTSJSONObject({class:i(["p-4 bg-white rounded-2xl mb-3",new UTSJSONObject({"dark-colon--important-bg-surface-800":p(m)})])}),{default:r((()=>[d(T,new UTSJSONObject({ref_key:"formRef",ref:E,modelValue:I.value,"onUpdate:modelValue":a[4]||(a[4]=(e=null)=>I.value=e),rules:p(M),disabled:P.value}),{default:r((()=>[d(j,new UTSJSONObject({label:p(s)("收货人"),prop:"contact",required:""}),{default:r((()=>[d(c,new UTSJSONObject({modelValue:I.value.contact,"onUpdate:modelValue":a[0]||(a[0]=(e=null)=>I.value.contact=e),placeholder:p(s)("请输入收货人姓名")}),null,8,["modelValue","placeholder"])])),_:1},8,["label"]),d(j,new UTSJSONObject({label:p(s)("手机号"),prop:"phone",required:""}),{default:r((()=>[d(c,new UTSJSONObject({modelValue:I.value.phone,"onUpdate:modelValue":a[1]||(a[1]=(e=null)=>I.value.phone=e),placeholder:p(s)("请输入手机号"),maxlength:11,type:"number"}),null,8,["modelValue","placeholder"])])),_:1},8,["label"]),d(j,new UTSJSONObject({label:p(s)("地区"),prop:"province",required:""}),{default:r((()=>[d(w,new UTSJSONObject({modelValue:H.value,"onUpdate:modelValue":a[2]||(a[2]=(e=null)=>H.value=e),placeholder:p(s)("选择省市区"),options:p(G),onChange:$}),null,8,["modelValue","placeholder","options"])])),_:1},8,["label"]),d(j,new UTSJSONObject({label:p(s)("详细地址"),prop:"address",required:""}),{default:r((()=>[d(c,new UTSJSONObject({modelValue:I.value.address,"onUpdate:modelValue":a[3]||(a[3]=(e=null)=>I.value.address=e),placeholder:p(s)("小区楼栋、门牌号、村等")}),null,8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1},8,["modelValue","rules","disabled"])])),_:1},8,["class"]),d(A,null,{default:r((()=>[d(L,new UTSJSONObject({label:p(s)("默认地址")}),{default:r((()=>[d(C,new UTSJSONObject({modelValue:I.value.isDefault,"onUpdate:modelValue":a[5]||(a[5]=(e=null)=>I.value.isDefault=e)}),null,8,["modelValue"])])),_:1},8,["label"])])),_:1})])),_:1}),d(K,null,{default:r((()=>[d(B,new UTSJSONObject({onClick:a[6]||(a[6]=(e=null)=>function(){F(((e,l)=>b(this,void 0,void 0,(function*(){if(e){z.showLoading(s("保存中"));const e=v(H.value,3),l=e[0],a=e[1],t=e[2];P.value=!0;const o=new UTSJSONObject(Object.assign(Object.assign({},I.value),{province:l,city:a,district:t}));n({url:"/app/user/address/".concat(""!=R.id?"update":"add"),method:"POST",data:o}).then((()=>{S.back()})).catch(((e=null)=>{z.showToast({message:e.message})})).finally((()=>{z.hideLoading(),P.value=!1}))}else z.showToast({message:l[0].message})}))))}())}),{default:r((()=>[f(O(p(s)("保存")),1)])),_:1})])),_:1})])),_:1}))}}});export{R as default};
