import{L as e,d as t,t as l,h as a,a as r,o as s,c as n,w as i,i as u,Y as c,_ as o,n as d,u as h,a6 as p,x as f,A as v,q as S,f as O,g as b,ax as _,a0 as m,r as w,V as T,W as g,l as N,e as y,au as U,av as x,F as j,Q as J,m as k,at as H,a2 as B,a5 as V,a3 as R,J as $,az as A}from"./index-OmDYQuYg.js";import{r as E,_ as I,c as z,h as C,l as M}from"./cl-page.uvue_vue_type_script_setup_true_lang.0nEhSiOF.js";function P(t){return t.map((t=>e(Object.assign(Object.assign({},t),{value:t}))))}function W(t){return t.map((t=>e(t)))}UTS.UTSType;const Y=z(t({__name:"cl-empty",props:{pt:{type:Object,default:()=>new UTSJSONObject({})},text:{type:String,default:()=>l("暂无数据")},icon:{type:String,default:"comm"},iconSize:{type:[Number,String],default:120},showIcon:{type:Boolean,default:!0},fixed:{type:Boolean,default:!0}},setup(e){const t=e,l=a((()=>c(t.pt)));return(t=null,a=null)=>{const c=_,m=E(r("cl-text"),I),w=o;return s(),n(w,new UTSJSONObject({class:u(["cl-empty",[new UTSJSONObject({}),new UTSJSONObject({"cl-empty--fixed":e.fixed}),l.value.className]])}),new UTSJSONObject({default:i((()=>[e.showIcon?(s(),n(c,new UTSJSONObject({key:0,class:"cl-empty__icon",src:"/static/empty/".concat(e.icon,".png"),style:d({height:h(p)(e.iconSize)}),mode:"aspectFit"}),null,8,["src","style"])):f("",!0),e.text?(s(),n(m,new UTSJSONObject({key:1,pt:new UTSJSONObject({className:h(v)(["cl-empty__text",new UTSJSONObject({"-important-text-surface-100":h(S)})])})}),new UTSJSONObject({default:i((()=>[O(b(e.text),1)])),_:1}),8,["pt"])):f("",!0)])),_:1}),8,["class"])}}}),[["__scopeId","data-v-89cdb06b"]]);UTS.UTSType;const D=z(t(Object.assign({name:"cl-index-bar"},{__name:"cl-index-bar",props:{pt:{type:Object,default:()=>new UTSJSONObject({})},modelValue:{type:Number,default:0},list:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,t){var l=t.emit;const r=e,d=l,p=m().proxy,f=a((()=>c(r.pt))),v=w({height:0,width:0,left:0,top:0}),_=w([]),$=w(!1),A=w(!1),E=w(""),I=w(-1);function z(){B((()=>{setTimeout((()=>{V().in(p).select(".cl-index-bar").boundingClientRect().exec((e=>{if(R(e))return null;v.value=e[0],V().in(p).selectAll(".cl-index-bar__item").boundingClientRect().exec((e=>{if(R(e))return z(),null;_.value=e[0]}))}))}),350)}))}function C(e){var t,l;if(0==_.value.length)return 0;let a=0,s=Number.MAX_VALUE;for(let r=0;r<_.value.length;r++){const n=_.value[r],i=(null!==(t=n.top)&&void 0!==t?t:0)+(null!==(l=n.height)&&void 0!==l?l:0)/2,u=Math.abs(e-i);u<s&&(s=u,a=r)}return a<0?a=0:a>=r.list.length&&(a=r.list.length-1),a}function M(e){I.value=e,E.value=r.list[e]}function P(e){$.value=!0,A.value=!0;M(C(e.touches[0].clientY))}function W(e){if(!$.value)return null;M(C(e.touches[0].clientY))}function Y(){$.value=!1,r.modelValue!=I.value&&(d("update:modelValue",I.value),d("change",I.value)),setTimeout((()=>{A.value=!1}),500)}return T(a((()=>r.modelValue)),(e=>{I.value=e}),{immediate:!0}),g((()=>{T(a((()=>r.list)),(()=>{z()}),{immediate:!0})})),(t=null,l=null)=>{const a=H,r=o;return s(),N(j,null,[y(r,new UTSJSONObject({class:u(["cl-index-bar",[new UTSJSONObject({}),f.value.className]])}),{default:i((()=>[y(r,new UTSJSONObject({class:"cl-index-bar__list",onTouchstart:P,onTouchmove:J(W,["stop","prevent"]),onTouchend:Y}),{default:i((()=>[(s(!0),N(j,null,k(e.list,((e,t)=>(s(),n(r,new UTSJSONObject({class:"cl-index-bar__item",key:t}),new UTSJSONObject({default:i((()=>[y(r,new UTSJSONObject({class:u(["cl-index-bar__item-inner",new UTSJSONObject({"is-active":I.value==t})])}),{default:i((()=>[y(a,new UTSJSONObject({class:u(["cl-index-bar__item-text",new UTSJSONObject({"dark-colon-text-surface-50":h(S),"is-active":I.value==t||h(S)})])}),{default:i((()=>[O(b(e),1)])),_:2},1032,["class"])])),_:2},1032,["class"])])),_:2}),1024)))),128))])),_:1})])),_:1},8,["class"]),U(y(r,new UTSJSONObject({class:"cl-index-bar__alert"}),{default:i((()=>[y(r,new UTSJSONObject({class:u(["cl-index-bar__alert-icon",new UTSJSONObject({"dark-colon--important-bg-surface-800":h(S)})])}),{default:i((()=>[y(r,new UTSJSONObject({class:u(["cl-index-bar__alert-arrow",new UTSJSONObject({"dark-colon--important-bg-surface-800":h(S)})])}),null,8,["class"]),y(a,new UTSJSONObject({class:u(["cl-index-bar__alert-text",new UTSJSONObject({"dark-colon-text-surface-50":h(S),"dark-colon--important-text-white":h(S)})])}),{default:i((()=>[O(b(E.value),1)])),_:1},8,["class"])])),_:1},8,["class"])])),_:1},512),[[x,A.value]])],64)}}})),[["__scopeId","data-v-d5380a69"]]);class F extends UTS.UTSType{static get$UTSMetadata$(){return{kind:2,get fields(){return{className:{type:String,optional:!0},item:{type:"Unknown",optional:!0},itemHover:{type:"Unknown",optional:!0},list:{type:"Unknown",optional:!0},indexBar:{type:"Unknown",optional:!0},scroller:{type:"Unknown",optional:!0},refresher:{type:"Unknown",optional:!0}}}}}constructor(e,t=F.get$UTSMetadata$(),l=!1){super(),this.__props__=UTS.UTSType.initProps(e,t,l),this.className=this.__props__.className,this.item=this.__props__.item,this.itemHover=this.__props__.itemHover,this.list=this.__props__.list,this.indexBar=this.__props__.indexBar,this.scroller=this.__props__.scroller,this.refresher=this.__props__.refresher,delete this.__props__}}const L=z(t(Object.assign({name:"cl-list-view"},{__name:"cl-list-view",props:{pt:{type:Object,default:()=>new UTSJSONObject({})},data:{type:Array,default:()=>[]},itemHeight:{type:Number,default:50},headerHeight:{type:Number,default:32},topHeight:{type:Number,default:0},bottomHeight:{type:Number,default:0},bufferSize:{type:Number,default:15},virtual:{type:Boolean,default:!0},scrollIntoView:{type:String,default:""},scrollWithAnimation:{type:Boolean,default:!1},showScrollbar:{type:Boolean,default:!1},refresherEnabled:{type:Boolean,default:!1},refresherThreshold:{type:Number,default:50},refresherBackground:{type:String,default:"transparent"},refresherDefaultText:{type:String,default:()=>l("下拉刷新")},refresherPullingText:{type:String,default:()=>l("释放立即刷新")},refresherRefreshingText:{type:String,default:()=>l("加载中")},showBackTop:{type:Boolean,default:!0}},emits:["item-tap","refresher-pulling","refresher-refresh","refresher-restore","refresher-abort","scrolltoupper","scrolltolower","scroll","scrollend","pull","top","bottom"],setup(e,t){var l=t.expose,p=t.emit;const _=e,U=p,x=m().proxy,J=a((()=>c(_.pt))),H=w(0),z=a((()=>R(_.data))),P=a((()=>_.data.every((e=>null!=e.index))&&!z.value)),W=a((()=>{const e=[];return _.data.forEach((t=>{var l;const a=e.findIndex((e=>e.index==t.index));-1!=a?e[a].children.push(t):e.push({index:null!==(l=t.index)&&void 0!==l?l:"",children:[t]})})),e})),F=a((()=>W.value.map((e=>e.index)))),L=a((()=>{const e=[];let t=_.topHeight,l=0;return W.value.forEach(((a,r)=>{""!=a.index&&(e.push({key:"header-".concat(r),type:"header",index:l++,top:t,height:_.headerHeight,data:{label:a.index,index:a.index}}),t+=_.headerHeight),a.children.forEach(((a,s)=>{e.push({key:"item-".concat(r,"-").concat(s),type:"item",index:l++,top:t,height:_.itemHeight,data:a}),t+=_.itemHeight}))})),e})),q=a((()=>L.value.reduce(((e,t)=>e+t.height),0)+_.topHeight+_.bottomHeight)),Q=w(0),X=w(0),G=w(0),K=a((()=>{if(R(L.value))return[];if(!_.virtual)return L.value;const e=_.bufferSize*_.itemHeight,t=Q.value-e,l=Q.value+G.value+e,a=[];let r=0,s=L.value.length-1;for(;r<s;){const e=Math.floor((r+s)/2),l=L.value[e];l.top+l.height<=t?r=e+1:s=e}for(let n=r;n<L.value.length;n++){const e=L.value[n];if(e.top>=l)break;e.top+e.height>t&&a.push(e)}return a})),Z=a((()=>R(K.value)?0:K.value[0].top)),ee=a((()=>{if(R(K.value))return 0;const e=K.value[K.value.length-1];return q.value-(e.top+e.height)})),te=a((()=>new UTSJSONObject({height:_.virtual?"".concat(q.value,"px"):"auto"}))),le=a((()=>new UTSJSONObject({height:_.virtual?"".concat(Z.value,"px"):"auto"}))),ae=a((()=>new UTSJSONObject({height:_.virtual?"".concat(ee.value,"px"):"auto"}))),re=w([]);const se=w(!1),ne=w("default"),ie=a((()=>{switch(ne.value){case"pulling":return _.refresherPullingText;case"refreshing":return _.refresherRefreshingText;default:return _.refresherDefaultText}}));function ue(e){U("scrolltoupper",e),U("top")}function ce(e){U("scrolltolower",e),U("bottom")}let oe=!1;function de(e){if(Q.value=Math.floor(e.detail.scrollTop),oe)return null;re.value.forEach(((e,t)=>{Q.value>=e&&(H.value=t)})),U("scroll",e)}function he(e){U("scrollend",e)}function pe(e){oe=!0,X.value=re.value[e],setTimeout((()=>{oe=!1}),300)}function fe(e){e.detail.dy>_.refresherThreshold&&(ne.value="pulling"),U("refresher-pulling",e)}function ve(e){ne.value="refreshing",se.value=!0,U("refresher-refresh",e),U("pull",e)}function Se(e){ne.value="default",U("refresher-restore",e)}function Oe(e){ne.value="default",U("refresher-abort",e)}function be(){X.value=.01,B((()=>{X.value=0}))}return g((()=>{setTimeout((()=>{V().in(x).select(".cl-list-view__scroller").boundingClientRect().exec((e=>{var t;if(R(e))return null;G.value=null!==(t=e[0].height)&&void 0!==t?t:0}))}),100),T(a((()=>_.data)),(()=>{!function(){const e=[];let t=0;W.value.forEach((l=>{e.push(t),t+=_.headerHeight+l.children.length*_.itemHeight})),re.value=e}()}),{immediate:!0})})),l(new UTSJSONObject({data:W,stopRefresh:function(){se.value=!1,ne.value="default"}})),(t=null,l=null)=>{const a=E(r("cl-loading"),C),c=E(r("cl-text"),I),p=o,_=E(r("cl-empty"),Y),m=A,w=E(r("cl-index-bar"),D),T=E(r("cl-back-top"),M);return s(),n(p,new UTSJSONObject({class:u(["cl-list-view",[new UTSJSONObject({}),J.value.className]])}),{default:i((()=>{var r,o;return[y(m,{class:u(["cl-list-view__scroller",[new UTSJSONObject({}),null===(r=J.value.scroller)||void 0===r?null:r.className]]),"scroll-top":X.value,"scroll-into-view":e.scrollIntoView,"scroll-with-animation":e.scrollWithAnimation,"show-scrollbar":e.showScrollbar,"refresher-triggered":se.value,"refresher-enabled":e.refresherEnabled,"refresher-threshold":e.refresherThreshold,"refresher-background":e.refresherBackground,"refresher-default-style":"none",direction:"vertical",onScrolltoupper:ue,onScrolltolower:ce,onScroll:de,onScrollend:he,onRefresherpulling:fe,onRefresherrefresh:ve,onRefresherrestore:Se,onRefresherabort:Oe},{refresher:i((()=>{var l;return[y(p,{slot:"refresher",class:u(["cl-list-view__refresher",[new UTSJSONObject({}),new UTSJSONObject({"is-pulling":"pulling"===ne.value,"is-refreshing":"refreshing"===ne.value}),null===(l=J.value.refresher)||void 0===l?null:l.className]]),style:d({height:e.refresherThreshold+"px"})},{default:i((()=>[$(t.$slots,"refresher",new UTSJSONObject({status:ne.value,text:ie.value}),(()=>["refreshing"===ne.value?(s(),n(a,new UTSJSONObject({key:0,size:28,pt:new UTSJSONObject({className:"mr-2"})}))):f("",!0),y(c,null,{default:i((()=>[O(b(ie.value),1)])),_:1})]),!0)])),_:3},8,["class","style"])]})),default:i((()=>{var l;return[y(p,{class:u(["cl-list-view__virtual-list",[new UTSJSONObject({}),null===(l=J.value.list)||void 0===l?null:l.className]]),style:d(te.value)},{default:i((()=>[y(p,new UTSJSONObject({class:"cl-list-view__spacer-top",style:d(le.value)}),{default:i((()=>[$(t.$slots,"top",new UTSJSONObject({}),void 0,!0)])),_:3},8,["style"]),(s(!0),N(j,null,k(K.value,((l,a)=>(s(),n(p,new UTSJSONObject({key:l.key,class:"cl-list-view__virtual-item"}),{default:i((()=>{var r,o;return["header"==l.type?(s(),n(p,new UTSJSONObject({key:0,class:u(["cl-list-view__header",[new UTSJSONObject({}),new UTSJSONObject({"is-dark":h(S)})]]),style:d({height:e.headerHeight+"px"})}),new UTSJSONObject({default:i((()=>[$(t.$slots,"header",new UTSJSONObject({index:l.data.index}),(()=>[y(c,null,{default:i((()=>[O(b(l.data.label),1)])),_:2},1024)]),!0)])),_:2}),1032,["class","style"])):(s(),n(p,{key:1,class:u(["cl-list-view__item",[new UTSJSONObject({}),new UTSJSONObject({"is-dark":h(S)}),null===(r=J.value.item)||void 0===r?null:r.className]]),"hover-class":null===(o=J.value.itemHover)||void 0===o?null:o.className,style:d({height:e.virtual?e.itemHeight+"px":"auto"}),onClick:(e=null)=>function(e){U("item-tap",e.data)}(l)},new UTSJSONObject({default:i((()=>[$(t.$slots,"item",new UTSJSONObject({item:l,data:l.data,value:l.data.value,index:a}),(()=>[y(p,new UTSJSONObject({class:"cl-list-view__item-inner"}),{default:i((()=>[y(c,null,{default:i((()=>[O(b(l.data.label),1)])),_:2},1024)])),_:2},1024)]),!0)])),_:2}),1032,["class","hover-class","style","onClick"]))]})),_:2},1024)))),128)),y(p,new UTSJSONObject({class:"cl-list-view__spacer-bottom",style:d(ae.value)}),{default:i((()=>[$(t.$slots,"bottom",new UTSJSONObject({}),void 0,!0)])),_:3},8,["style"])])),_:3},8,["class","style"]),z.value?(s(),n(_,new UTSJSONObject({key:0,fixed:!1}))):f("",!0)]})),_:3},8,["class","scroll-top","scroll-into-view","scroll-with-animation","show-scrollbar","refresher-triggered","refresher-enabled","refresher-threshold","refresher-background"]),P.value?(s(),n(w,{key:0,modelValue:H.value,"onUpdate:modelValue":l[0]||(l[0]=(e=null)=>H.value=e),list:F.value,pt:{className:h(v)([null===(o=J.value.indexBar)||void 0===o?null:o.className])},onChange:pe},null,8,["modelValue","list","pt"])):f("",!0),P.value?(s(),n(p,new UTSJSONObject({key:1,class:u(["cl-list-view__index",[new UTSJSONObject({}),new UTSJSONObject({"is-dark":h(S)})]]),style:d({height:e.headerHeight+"px"})}),new UTSJSONObject({default:i((()=>[$(t.$slots,"index",new UTSJSONObject({index:F.value[H.value]}),(()=>[y(c,null,{default:i((()=>[O(b(F.value[H.value]),1)])),_:1})]),!0)])),_:3}),8,["class","style"])):f("",!0),e.showBackTop?(s(),n(T,new UTSJSONObject({key:2,top:Q.value,onBackTop:be}),null,8,["top"])):f("",!0)]})),_:3},8,["class"])}}})),[["__scopeId","data-v-7f26a413"]]);export{L as _,P as a,W as u};
