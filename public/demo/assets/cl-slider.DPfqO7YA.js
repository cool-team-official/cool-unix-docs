import{d as e,Z as a,h as t,r as l,T as s,a0 as n,a as u,o as i,c as r,w as c,i as o,U as m,a1 as p,_ as v,e as d,n as _,v as h,l as S,F as b,O as f,I as g,u as y,z as x,f as T,g as N,a2 as O,G as U,W as w}from"./index-CVBPP8er.js";import{r as k,_ as M,c as j}from"./cl-page.uvue_vue_type_script_setup_true_lang.SFzc29x8.js";import{u as J}from"./form.CyvXoDOu.js";class $ extends UTS.UTSType{static get$UTSMetadata$(){return{kind:2,get fields(){return{className:{type:String,optional:!0},track:{type:"Unknown",optional:!0},progress:{type:"Unknown",optional:!0},thumb:{type:"Unknown",optional:!0},value:{type:"Unknown",optional:!0}}}}}constructor(e,a=$.get$UTSMetadata$(),t=!1){super(),this.__props__=UTS.UTSType.initProps(e,a,t),this.className=this.__props__.className,this.track=this.__props__.track,this.progress=this.__props__.progress,this.thumb=this.__props__.thumb,this.value=this.__props__.value,delete this.__props__}}class V extends UTS.UTSType{static get$UTSMetadata$(){return{kind:2,get fields(){return{min:{type:Number,optional:!1},max:{type:Number,optional:!1}}}}}constructor(e,a=V.get$UTSMetadata$(),t=!1){super(),this.__props__=UTS.UTSType.initProps(e,a,t),this.min=this.__props__.min,this.max=this.__props__.max,delete this.__props__}}const z=j(e(Object.assign({name:"cl-slider"},{__name:"cl-slider",props:{pt:{type:Object,default:()=>new UTSJSONObject({})},modelValue:{type:Number,default:0},values:{type:Array,default:()=>[0,0]},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},disabled:{type:Boolean,default:!1},blockSize:{type:Number,default:40},trackHeight:{type:Number,default:8},showValue:{type:Boolean,default:!1},range:{type:Boolean,default:!1}},emits:["update:modelValue","update:values","change","changing"],setup(e,j){var $=j.emit;const z=e,P=$,B=a().proxy,H=t((()=>m(z.pt))),I=J().disabled,X=t((()=>z.disabled||I.value)),A=l(z.modelValue),C=l([...z.values]),F=l(0),G=l(0),R=l(0),W=t((()=>z.range?0:(A.value-z.min)/(z.max-z.min)*100)),Z=t((()=>{if(!z.range)return new V({min:0,max:0});const e=C.value,a=z.max-z.min,t=(e[0]-z.min)/a*100,l=(e[1]-z.min)/a*100;return new V({min:t,max:l})})),q=t((()=>{const e=new UTSJSONObject({});if(z.range){const a=Z.value,t=a.min,l=a.max;e.left="".concat(t,"%"),e.width="".concat(l-t,"%")}else e.width="".concat(W.value,"%");return e}));function D(e){const a=new UTSJSONObject({}),t=F.value-O(z.blockSize)+1,l=e/100*t,s=Math.max(0,Math.min(t,l));return a.left="".concat(s,"px"),a.width="".concat(O(z.blockSize),"px"),a.height="".concat(O(z.blockSize),"px"),a}const E=t((()=>D(W.value))),K=t((()=>D(Z.value.min))),L=t((()=>D(Z.value.max))),Q=t((()=>{if(z.range){const e=C.value;return"".concat(e[0]," - ").concat(e[1])}return"".concat(A.value)}));function Y(){return new Promise((e=>{p().in(B).select(".cl-slider__track").boundingClientRect(((a=null)=>{var t,l;F.value=null!==(t=a.width)&&void 0!==t?t:0,G.value=null!==(l=a.left)&&void 0!==l?l:0,e()})).exec()}))}function ee(e){if(0==F.value)return z.min;const a=e-G.value,t=Math.max(0,Math.min(1,a/F.value)),l=z.max-z.min;let s=z.min+t*l;return z.step>0&&(s=Math.round((s-z.min)/z.step)*z.step+z.min),Math.max(z.min,Math.min(z.max,s))}function ae(e){if(z.range){const a=e,t=C.value;a[0]>a[1]&&(R.value=1-R.value);const l=[Math.min(a[0],a[1]),Math.max(a[0],a[1])];UTS.JSON.stringify(t)!==UTS.JSON.stringify(l)&&(C.value=l,P("update:values",l),P("changing",l))}else{const a=e;A.value!==a&&(A.value=a,P("update:modelValue",a),P("changing",a))}}function te(e){return U(this,void 0,void 0,(function*(){if(X.value)return Promise.resolve(null);yield Y(),w((()=>{const a=e.touches[0].clientX,t=ee(a);if(z.range){R.value=function(e){if(!z.range)return 0;const a=C.value,t=ee(e);return Math.abs(t-a[0])<=Math.abs(t-a[1])?0:1}(a);const e=[...C.value];e[R.value]=t,ae(e)}else ae(t)}))}))}function le(e){if(X.value)return null;const a=ee(e.touches[0].clientX);if(z.range){const e=[...C.value];e[R.value]=a,ae(e)}else ae(a)}function se(){if(X.value)return null;z.range?P("change",C.value):P("change",A.value)}return s(t((()=>z.modelValue)),(e=>{e!==A.value&&(A.value=Math.max(z.min,Math.min(z.max,e)))}),{immediate:!0}),s(t((()=>z.values)),(e=>{C.value=e.map((e=>Math.max(z.min,Math.min(z.max,e))))}),{immediate:!0}),s(t((()=>z.max)),(e=>{if(z.range){const a=C.value;(a[0]>e||a[1]>e)&&ae([Math.min(a[0],e),Math.min(a[1],e)])}else{A.value>e&&ae(e)}}),{immediate:!0}),s(t((()=>z.min)),(e=>{if(z.range){const a=C.value;(a[0]<e||a[1]<e)&&ae([Math.max(a[0],e),Math.max(a[1],e)])}else{A.value<e&&ae(e)}}),{immediate:!0}),n((()=>{s(t((()=>[z.showValue])),(()=>{w((()=>{Y()}))})),Y()})),(a=null,t=null)=>{const l=v,s=k(u("cl-text"),M);return i(),r(l,new UTSJSONObject({class:o(["cl-slider",[new UTSJSONObject({}),new UTSJSONObject({"cl-slider--disabled":X.value}),H.value.className]])}),{default:c((()=>[d(l,new UTSJSONObject({class:"cl-slider__inner",style:_({height:e.blockSize+8+"rpx"})}),{default:c((()=>{var a;return[d(l,{class:o(["cl-slider__track",[new UTSJSONObject({}),null===(a=H.value.track)||void 0===a?null:a.className]]),style:_({height:e.trackHeight+"rpx"})},{default:c((()=>{var a,t,s,n;return[d(l,{class:o(["cl-slider__progress",[new UTSJSONObject({}),null===(a=H.value.progress)||void 0===a?null:a.className]]),style:_(q.value)},null,8,["class","style"]),e.range?h("",!0):(i(),r(l,{key:0,class:o(["cl-slider__thumb",[new UTSJSONObject({}),null===(t=H.value.thumb)||void 0===t?null:t.className]]),style:_(E.value)},null,8,["class","style"])),e.range?(i(),S(b,new UTSJSONObject({key:1}),[d(l,{class:o(["cl-slider__thumb cl-slider__thumb--min",[new UTSJSONObject({}),null===(s=H.value.thumb)||void 0===s?null:s.className]]),style:_(K.value)},null,8,["class","style"]),d(l,{class:o(["cl-slider__thumb cl-slider__thumb--max",[new UTSJSONObject({}),null===(n=H.value.thumb)||void 0===n?null:n.className]]),style:_(L.value)},null,8,["class","style"])],64)):h("",!0)]})),_:1},8,["class","style"]),d(l,new UTSJSONObject({class:"cl-slider__picker",style:_({height:1.5*e.blockSize+"rpx"}),onTouchstart:f(te,["prevent"]),onTouchmove:f(le,["prevent"]),onTouchend:se,onTouchcancel:se}),null,8,["style"])]})),_:1},8,["style"]),g(a.$slots,"value",new UTSJSONObject({value:Q.value}),(()=>{var a;return[e.showValue?(i(),r(s,{key:0,pt:{className:y(x)(["text-center w--bracket-start-100rpx-bracket-end-",null===(a=H.value.value)||void 0===a?null:a.className])}},new UTSJSONObject({default:c((()=>[T(N(Q.value),1)])),_:1}),8,["pt"])):h("",!0)]}),!0)])),_:3},8,["class"])}}})),[["__scopeId","data-v-ce96877a"]]);export{z as _};
