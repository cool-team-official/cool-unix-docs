import{J as e,d as t,t as l,c as a,o as r,a as s,w as n,n as i,W as u,_ as c,X as o,u as d,a5 as h,q as p,e as f,f as v,g as S,av as O,m as _,Z as b,z as m,T as w,U as T,j as g,b as y,as as N,at as U,F as x,O as j,k as J,a1 as k,a4 as H,a2 as B,r as V,H as R,x as $,ax as E}from"./index-BAeoAK27.js";import{c as I,r as A,h as z,a as C,l as M}from"./cl-page.uvue_vue_type_script_setup_true_lang.CFvuOJz5.js";function P(t){return t.map((t=>e(Object.assign(Object.assign({},t),{value:t}))))}function W(t){return t.map((t=>e(t)))}UTS.UTSType;const D=I(t({__name:"cl-empty",props:{pt:{type:Object,default:()=>new UTSJSONObject({})},text:{type:String,default:()=>l("暂无数据")},icon:{type:String,default:"comm"},iconSize:{type:[Number,String],default:120},showIcon:{type:Boolean,default:!0},fixed:{type:Boolean,default:!0}},setup(e){const t=e,l=a((()=>u(t.pt)));return(t=null,a=null)=>{const u=O,b=_,m=c;return r(),s(m,new UTSJSONObject({class:i(["cl-empty",[new UTSJSONObject({}),new UTSJSONObject({"cl-empty--fixed":e.fixed}),l.value.className]])}),new UTSJSONObject({default:n((()=>[e.showIcon?(r(),s(u,new UTSJSONObject({key:0,class:"cl-empty__icon",src:"/static/empty/".concat(e.icon,".png"),style:o({height:d(h)(e.iconSize)}),mode:"aspectFit"}),null,8,["src","style"])):p("",!0),e.text?(r(),s(b,new UTSJSONObject({key:1,class:i(["cl-empty__text",new UTSJSONObject({"dark-colon-text-surface-50":d(f),"dark-colon--important-text-surface-100":d(f)})])}),new UTSJSONObject({default:n((()=>[v(S(e.text),1)])),_:1}),8,["class"])):p("",!0)])),_:1}),8,["class"])}}}),[["__scopeId","data-v-3d7c4d9f"]]);UTS.UTSType;const F=I(t(Object.assign({name:"cl-index-bar"},{__name:"cl-index-bar",props:{pt:{type:Object,default:()=>new UTSJSONObject({})},modelValue:{type:Number,default:0},list:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,t){var l=t.emit;const o=e,h=l,p=b().proxy,O=a((()=>u(o.pt))),V=m({height:0,width:0,left:0,top:0}),R=m([]),$=m(!1),E=m(!1),I=m(""),A=m(-1);function z(){k((()=>{setTimeout((()=>{H().in(p).select(".cl-index-bar").boundingClientRect().exec((e=>{if(B(e))return null;V.value=e[0],H().in(p).selectAll(".cl-index-bar__item").boundingClientRect().exec((e=>{if(B(e))return z(),null;R.value=e[0]}))}))}),350)}))}function C(e){var t,l;if(0==R.value.length)return 0;let a=0,r=Number.MAX_VALUE;for(let s=0;s<R.value.length;s++){const n=R.value[s],i=(null!==(t=n.top)&&void 0!==t?t:0)+(null!==(l=n.height)&&void 0!==l?l:0)/2,u=Math.abs(e-i);u<r&&(r=u,a=s)}return a<0?a=0:a>=o.list.length&&(a=o.list.length-1),a}function M(e){A.value=e,I.value=o.list[e]}function P(e){$.value=!0,E.value=!0;M(C(e.touches[0].clientY))}function W(e){if(!$.value)return null;M(C(e.touches[0].clientY))}function D(){$.value=!1,o.modelValue!=A.value&&(h("update:modelValue",A.value),h("change",A.value)),setTimeout((()=>{E.value=!1}),500)}return w(a((()=>o.modelValue)),(e=>{A.value=e}),{immediate:!0}),T((()=>{w(a((()=>o.list)),(()=>{z()}),{immediate:!0})})),(t=null,l=null)=>{const a=_,u=c;return r(),g(x,null,[y(u,new UTSJSONObject({class:i(["cl-index-bar",[new UTSJSONObject({}),O.value.className]])}),{default:n((()=>[y(u,new UTSJSONObject({class:"cl-index-bar__list",onTouchstart:P,onTouchmove:j(W,["stop","prevent"]),onTouchend:D}),{default:n((()=>[(r(!0),g(x,null,J(e.list,((e,t)=>(r(),s(u,new UTSJSONObject({class:"cl-index-bar__item",key:t}),new UTSJSONObject({default:n((()=>[y(u,new UTSJSONObject({class:i(["cl-index-bar__item-inner",new UTSJSONObject({"is-active":A.value==t})])}),{default:n((()=>[y(a,new UTSJSONObject({class:i(["cl-index-bar__item-text",new UTSJSONObject({"dark-colon-text-surface-50":d(f),"is-active":A.value==t||d(f)})])}),{default:n((()=>[v(S(e),1)])),_:2},1032,["class"])])),_:2},1032,["class"])])),_:2}),1024)))),128))])),_:1})])),_:1},8,["class"]),N(y(u,new UTSJSONObject({class:"cl-index-bar__alert"}),{default:n((()=>[y(u,new UTSJSONObject({class:i(["cl-index-bar__alert-icon",new UTSJSONObject({"dark-colon--important-bg-surface-800":d(f)})])}),{default:n((()=>[y(u,new UTSJSONObject({class:i(["cl-index-bar__alert-arrow",new UTSJSONObject({"dark-colon--important-bg-surface-800":d(f)})])}),null,8,["class"]),y(a,new UTSJSONObject({class:i(["cl-index-bar__alert-text",new UTSJSONObject({"dark-colon-text-surface-50":d(f),"dark-colon--important-text-white":d(f)})])}),{default:n((()=>[v(S(I.value),1)])),_:1},8,["class"])])),_:1},8,["class"])])),_:1},512),[[U,E.value]])],64)}}})),[["__scopeId","data-v-d5380a69"]]);class X extends UTS.UTSType{static get$UTSMetadata$(){return{kind:2,get fields(){return{className:{type:String,optional:!0},item:{type:"Unknown",optional:!0},itemHover:{type:"Unknown",optional:!0},list:{type:"Unknown",optional:!0},indexBar:{type:"Unknown",optional:!0},scroller:{type:"Unknown",optional:!0},refresher:{type:"Unknown",optional:!0}}}}}constructor(e,t=X.get$UTSMetadata$(),l=!1){super(),this.__props__=UTS.UTSType.initProps(e,t,l),this.className=this.__props__.className,this.item=this.__props__.item,this.itemHover=this.__props__.itemHover,this.list=this.__props__.list,this.indexBar=this.__props__.indexBar,this.scroller=this.__props__.scroller,this.refresher=this.__props__.refresher,delete this.__props__}}const Y=I(t(Object.assign({name:"cl-list-view"},{__name:"cl-list-view",props:{pt:{type:Object,default:()=>new UTSJSONObject({})},data:{type:Array,default:()=>[]},itemHeight:{type:Number,default:50},headerHeight:{type:Number,default:32},topHeight:{type:Number,default:0},bottomHeight:{type:Number,default:0},bufferSize:{type:Number,default:15},virtual:{type:Boolean,default:!0},scrollIntoView:{type:String,default:""},scrollWithAnimation:{type:Boolean,default:!1},showScrollbar:{type:Boolean,default:!1},refresherEnabled:{type:Boolean,default:!1},refresherThreshold:{type:Number,default:50},refresherBackground:{type:String,default:"transparent"},refresherDefaultText:{type:String,default:()=>l("下拉刷新")},refresherPullingText:{type:String,default:()=>l("释放立即刷新")},refresherRefreshingText:{type:String,default:()=>l("加载中")},showBackTop:{type:Boolean,default:!0}},emits:["item-tap","refresher-pulling","refresher-refresh","refresher-restore","refresher-abort","scrolltoupper","scrolltolower","scroll","scrollend","pull","top","bottom"],setup(e,t){var l=t.expose,h=t.emit;const O=e,_=h,N=b().proxy,U=a((()=>u(O.pt))),j=m(0),I=a((()=>B(O.data))),P=a((()=>O.data.every((e=>null!=e.index))&&!I.value)),W=a((()=>{const e=[];return O.data.forEach((t=>{var l;const a=e.findIndex((e=>e.index==t.index));-1!=a?e[a].children.push(t):e.push({index:null!==(l=t.index)&&void 0!==l?l:"",children:[t]})})),e})),X=a((()=>W.value.map((e=>e.index)))),Y=a((()=>{const e=[];let t=O.topHeight,l=0;return W.value.forEach(((a,r)=>{""!=a.index&&(e.push({key:"header-".concat(r),type:"header",index:l++,top:t,height:O.headerHeight,data:{label:a.index,index:a.index}}),t+=O.headerHeight),a.children.forEach(((a,s)=>{e.push({key:"item-".concat(r,"-").concat(s),type:"item",index:l++,top:t,height:O.itemHeight,data:a}),t+=O.itemHeight}))})),e})),q=a((()=>Y.value.reduce(((e,t)=>e+t.height),0)+O.topHeight+O.bottomHeight)),L=m(0),Z=m(0),G=m(0),K=a((()=>{if(B(Y.value))return[];if(!O.virtual)return Y.value;const e=O.bufferSize*O.itemHeight,t=L.value-e,l=L.value+G.value+e,a=[];let r=0,s=Y.value.length-1;for(;r<s;){const e=Math.floor((r+s)/2),l=Y.value[e];l.top+l.height<=t?r=e+1:s=e}for(let n=r;n<Y.value.length;n++){const e=Y.value[n];if(e.top>=l)break;e.top+e.height>t&&a.push(e)}return a})),Q=a((()=>B(K.value)?0:K.value[0].top)),ee=a((()=>{if(B(K.value))return 0;const e=K.value[K.value.length-1];return q.value-(e.top+e.height)})),te=a((()=>new UTSJSONObject({height:O.virtual?"".concat(q.value,"px"):"auto"}))),le=a((()=>new UTSJSONObject({height:O.virtual?"".concat(Q.value,"px"):"auto"}))),ae=a((()=>new UTSJSONObject({height:O.virtual?"".concat(ee.value,"px"):"auto"}))),re=m([]);const se=m(!1),ne=m("default"),ie=a((()=>{switch(ne.value){case"pulling":return O.refresherPullingText;case"refreshing":return O.refresherRefreshingText;default:return O.refresherDefaultText}}));function ue(e){_("scrolltoupper",e),_("top")}function ce(e){_("scrolltolower",e),_("bottom")}let oe=!1;function de(e){if(L.value=Math.floor(e.detail.scrollTop),oe)return null;re.value.forEach(((e,t)=>{L.value>=e&&(j.value=t)})),_("scroll",e)}function he(e){_("scrollend",e)}function pe(e){oe=!0,Z.value=re.value[e],setTimeout((()=>{oe=!1}),300)}function fe(e){e.detail.dy>O.refresherThreshold&&(ne.value="pulling"),_("refresher-pulling",e)}function ve(e){ne.value="refreshing",se.value=!0,_("refresher-refresh",e),_("pull",e)}function Se(e){ne.value="default",_("refresher-restore",e)}function Oe(e){ne.value="default",_("refresher-abort",e)}function _e(){Z.value=.01,k((()=>{Z.value=0}))}return T((()=>{setTimeout((()=>{H().in(N).select(".cl-list-view__scroller").boundingClientRect().exec((e=>{var t;if(B(e))return null;G.value=null!==(t=e[0].height)&&void 0!==t?t:0}))}),100),w(a((()=>O.data)),(()=>{!function(){const e=[];let t=0;W.value.forEach((l=>{e.push(t),t+=O.headerHeight+l.children.length*O.itemHeight})),re.value=e}()}),{immediate:!0})})),l(new UTSJSONObject({data:W,stopRefresh:function(){se.value=!1,ne.value="default"}})),(t=null,l=null)=>{const a=A(V("cl-loading"),z),u=A(V("cl-text"),C),h=c,O=A(V("cl-empty"),D),b=E,m=A(V("cl-index-bar"),F),w=A(V("cl-back-top"),M);return r(),s(h,new UTSJSONObject({class:i(["cl-list-view",[new UTSJSONObject({}),U.value.className]])}),{default:n((()=>{var c,T;return[y(b,{class:i(["cl-list-view__scroller",[new UTSJSONObject({}),null===(c=U.value.scroller)||void 0===c?null:c.className]]),"scroll-top":Z.value,"scroll-into-view":e.scrollIntoView,"scroll-with-animation":e.scrollWithAnimation,"show-scrollbar":e.showScrollbar,"refresher-triggered":se.value,"refresher-enabled":e.refresherEnabled,"refresher-threshold":e.refresherThreshold,"refresher-background":e.refresherBackground,"refresher-default-style":"none",direction:"vertical",onScrolltoupper:ue,onScrolltolower:ce,onScroll:de,onScrollend:he,onRefresherpulling:fe,onRefresherrefresh:ve,onRefresherrestore:Se,onRefresherabort:Oe},{refresher:n((()=>{var l;return[y(h,{slot:"refresher",class:i(["cl-list-view__refresher",[new UTSJSONObject({}),new UTSJSONObject({"is-pulling":"pulling"===ne.value,"is-refreshing":"refreshing"===ne.value}),null===(l=U.value.refresher)||void 0===l?null:l.className]]),style:o({height:e.refresherThreshold+"px"})},{default:n((()=>[R(t.$slots,"refresher",new UTSJSONObject({status:ne.value,text:ie.value}),(()=>["refreshing"===ne.value?(r(),s(a,new UTSJSONObject({key:0,size:28,pt:new UTSJSONObject({className:"mr-2"})}))):p("",!0),y(u,null,{default:n((()=>[v(S(ie.value),1)])),_:1})]),!0)])),_:3},8,["class","style"])]})),default:n((()=>{var l;return[y(h,{class:i(["cl-list-view__virtual-list",[new UTSJSONObject({}),null===(l=U.value.list)||void 0===l?null:l.className]]),style:o(te.value)},{default:n((()=>[y(h,new UTSJSONObject({class:"cl-list-view__spacer-top",style:o(le.value)}),{default:n((()=>[R(t.$slots,"top",new UTSJSONObject({}),void 0,!0)])),_:3},8,["style"]),(r(!0),g(x,null,J(K.value,((l,a)=>(r(),s(h,new UTSJSONObject({key:l.key,class:"cl-list-view__virtual-item"}),{default:n((()=>{var c,p;return["header"==l.type?(r(),s(h,new UTSJSONObject({key:0,class:i(["cl-list-view__header",[new UTSJSONObject({}),new UTSJSONObject({"is-dark":d(f)})]]),style:o({height:e.headerHeight+"px"})}),new UTSJSONObject({default:n((()=>[R(t.$slots,"header",new UTSJSONObject({index:l.data.index}),(()=>[y(u,null,{default:n((()=>[v(S(l.data.label),1)])),_:2},1024)]),!0)])),_:2}),1032,["class","style"])):(r(),s(h,{key:1,class:i(["cl-list-view__item",[new UTSJSONObject({}),new UTSJSONObject({"is-dark":d(f)}),null===(c=U.value.item)||void 0===c?null:c.className]]),"hover-class":null===(p=U.value.itemHover)||void 0===p?null:p.className,style:o({height:e.virtual?e.itemHeight+"px":"auto"}),onClick:(e=null)=>function(e){_("item-tap",e.data)}(l)},new UTSJSONObject({default:n((()=>[R(t.$slots,"item",new UTSJSONObject({item:l,data:l.data,value:l.data.value,index:a}),(()=>[y(h,new UTSJSONObject({class:"cl-list-view__item-inner"}),{default:n((()=>[y(u,null,{default:n((()=>[v(S(l.data.label),1)])),_:2},1024)])),_:2},1024)]),!0)])),_:2}),1032,["class","hover-class","style","onClick"]))]})),_:2},1024)))),128)),y(h,new UTSJSONObject({class:"cl-list-view__spacer-bottom",style:o(ae.value)}),{default:n((()=>[R(t.$slots,"bottom",new UTSJSONObject({}),void 0,!0)])),_:3},8,["style"])])),_:3},8,["class","style"]),I.value?(r(),s(O,new UTSJSONObject({key:0,fixed:!1}))):p("",!0)]})),_:3},8,["class","scroll-top","scroll-into-view","scroll-with-animation","show-scrollbar","refresher-triggered","refresher-enabled","refresher-threshold","refresher-background"]),P.value?(r(),s(m,{key:0,modelValue:j.value,"onUpdate:modelValue":l[0]||(l[0]=(e=null)=>j.value=e),list:X.value,pt:{className:d($)([null===(T=U.value.indexBar)||void 0===T?null:T.className])},onChange:pe},null,8,["modelValue","list","pt"])):p("",!0),P.value?(r(),s(h,new UTSJSONObject({key:1,class:i(["cl-list-view__index",[new UTSJSONObject({}),new UTSJSONObject({"is-dark":d(f)})]]),style:o({height:e.headerHeight+"px"})}),new UTSJSONObject({default:n((()=>[R(t.$slots,"index",new UTSJSONObject({index:X.value[j.value]}),(()=>[y(u,null,{default:n((()=>[v(S(X.value[j.value]),1)])),_:1})]),!0)])),_:3}),8,["class","style"])):p("",!0),e.showBackTop?(r(),s(w,new UTSJSONObject({key:2,top:L.value,onBackTop:_e}),null,8,["top"])):p("",!0)]})),_:3},8,["class"])}}})),[["__scopeId","data-v-7f26a413"]]);export{Y as _,P as a,W as u};
