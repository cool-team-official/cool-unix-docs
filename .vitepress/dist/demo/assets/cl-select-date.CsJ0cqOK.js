import{_ as e}from"./cl-select-trigger.BQKpn_xS.js";import{d as a,t,z as l,c as u,T as n,r,o as s,j as o,a as c,q as p,b as d,w as i,F as v,U as S,P as f,a8 as m,a9 as g,V as b,O,k as _,f as h,g as y,n as w,u as T,e as j,E as N,_ as U}from"./index-B5PxyFSj.js";import{f as J,u as k,r as x,a as Y,d as C,e as V,c as A}from"./cl-page.uvue_vue_type_script_setup_true_lang.Dp18cFvC.js";import{_ as F}from"./cl-tag.Cr9MZzsO.js";import{_ as M}from"./cl-picker-view.D_zCWCDn.js";import{d as B}from"./day.C6z4Qky5.js";class D extends UTS.UTSType{static get$UTSMetadata$(){return{kind:2,get fields(){return{trigger:{type:"Unknown",optional:!0},popup:{type:"Unknown",optional:!0}}}}}constructor(e,a=D.get$UTSMetadata$(),t=!1){super(),this.__props__=UTS.UTSType.initProps(e,a,t),this.trigger=this.__props__.trigger,this.popup=this.__props__.popup,delete this.__props__}}const P=A(a(Object.assign({name:"cl-select-date"},{__name:"cl-select-date",props:{pt:{type:Object,default:()=>new UTSJSONObject({})},modelValue:{type:String,default:""},values:{type:Array,default:()=>[]},headers:{type:Array,default:()=>[t("年"),t("月"),t("日"),t("时"),t("分"),t("秒")]},title:{type:String,default:()=>t("请选择")},placeholder:{type:String,default:()=>t("请选择")},showTrigger:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},confirmText:{type:String,default:()=>t("确定")},showConfirm:{type:Boolean,default:!0},cancelText:{type:String,default:()=>t("取消")},showCancel:{type:Boolean,default:!0},labelFormat:{type:String,default:""},valueFormat:{type:String,default:""},start:{type:String,default:J.startDate},end:{type:String,default:J.endDate},type:{type:String,default:"second"},rangeable:{type:Boolean,default:!1},startPlaceholder:{type:String,default:()=>t("开始日期")},endPlaceholder:{type:String,default:()=>t("结束日期")},rangeSeparator:{type:String,default:()=>t("")},showShortcuts:{type:Boolean,default:!0},shortcuts:{type:Array,default:()=>[]}},emits:["update:modelValue","change","update:values","range-change"],setup(a,J){var A=J.expose,D=J.emit;const P=a,$=D,z=k(),I=l(null),E=u((()=>S(P.pt))),H=u((()=>{switch(P.type){case"year":return"YYYY";case"month":return"YYYY-MM";case"date":return"YYYY-MM-DD";default:return"YYYY-MM-DD HH:mm:ss"}})),R=u((()=>f(P.labelFormat)||m(P.labelFormat)?H.value:P.labelFormat)),q=u((()=>f(P.valueFormat)||m(P.valueFormat)?H.value:P.valueFormat)),G=l(-1),K=u((()=>m(P.shortcuts)?[{label:t("今天"),value:[B().format(q.value),B().format(q.value)]},{label:t("近7天"),value:[B().subtract(7,"day").format(q.value),B().format(q.value)]},{label:t("近30天"),value:[B().subtract(30,"day").format(q.value),B().format(q.value)]},{label:t("近90天"),value:[B().subtract(90,"day").format(q.value),B().format(q.value)]},{label:t("近一年"),value:[B().subtract(1,"year").format(q.value),B().format(q.value)]}]:P.shortcuts)),L=l(0),Q=l(["",""]),W=l([]),X=u((()=>P.rangeable?0==L.value?P.start:Q.value[0]:P.start)),Z=u((()=>{const e=g(B(X.value).toArray(),6),a=e[0],t=e[1],l=e[2],u=e[3],n=e[4],r=e[5],s=g(B(P.end).toArray(),6),o=s[0],c=s[1],p=s[2],d=s[3],i=s[4],v=s[5],S=g(W.value,5),f=S[0],m=S[1],b=S[2],O=S[3],_=S[4],h=[[],[],[],[],[],[]],y=[31,f%4==0&&f%100!=0||f%400==0?29:28,31,30,31,30,31,31,30,31,30,31][m-1],w=Math.max(60,o-a+1);for(let g=0;g<w;g++){const e=a+g;e<=o&&h[0].push({label:e.toString(),value:e});let s=a==f?t+g:g+1;s<=(o==f?c:12)&&h[1].push({label:s.toString().padStart(2,"0"),value:s});let S=a==f&&t==m?l+g:g+1;S<=(o==f&&c==m?p:y)&&h[2].push({label:S.toString().padStart(2,"0"),value:S});let w=a==f&&t==m&&l==b?u+g:g;w<(o==f&&c==m&&p==b?d:24)&&h[3].push({label:w.toString().padStart(2,"0"),value:w});let T=a==f&&t==m&&l==b&&u==O?n+g:g;T<(o==f&&c==m&&p==b&&d==O?i:60)&&h[4].push({label:T.toString().padStart(2,"0"),value:T});let j=a==f&&t==m&&l==b&&u==O&&n==_?r+g:g;j<(o==f&&c==m&&p==b&&d==O&&i==_?v:60)&&h[5].push({label:j.toString().padStart(2,"0"),value:j})}return h})),ee=u((()=>["year","month","date","hour","minute","second"].findIndex((e=>e==P.type))+1)),ae=u((()=>Z.value.slice(0,ee.value))),te=u((()=>m(W.value)?[]:W.value.map(((e,a)=>{const t=Z.value[a].findIndex((a=>a.value==e));return-1==t?0:t}))));function le(){const e=[],a=[2e3,1,1,0,0,0];return["","-","-"," ",":",":"].forEach(((t,l)=>{let u=W.value[l];l>=ee.value&&(u=a[l]),e.push(t+u.toString().padStart(2,"0"))})),e.join("")}const ue=l("");function ne(){P.rangeable?ue.value=Q.value.map((e=>B(e).format(R.value))).join(" ".concat(P.rangeSeparator," ")):ue.value=B(le()).format(R.value)}function re(e){return N(this,void 0,void 0,(function*(){for(let a=0;a<e.length;a++)W.value[a]=Z.value[a][e[a]].value;P.rangeable&&(Q.value[L.value]=B(le()).format(q.value),B(Q.value[0]).isAfter(B(Q.value[1]))&&""!=Q.value[1]&&(Q.value[1]=Q.value[0]),G.value=-1)}))}function se(e){f(e)||m(e)?W.value=B().toArray():(W.value=B(e).toArray(),ne())}function oe(e){m(e)?Q.value=["",""]:Q.value=e}function ce(e){L.value=e,se(Q.value[e])}const pe=l(!1);let de=null;function ie(e=null){if(P.disabled)return null;pe.value=!0,de=e,b((()=>{P.rangeable?(L.value=0,oe(P.values),se(Q.value[0])):se(P.modelValue)}))}function ve(){pe.value=!1}function Se(){W.value=[],Q.value=[]}function fe(){ue.value="",P.rangeable?($("update:values",[]),$("range-change",[])):($("update:modelValue",""),$("change",""))}function me(){if(P.rangeable){const e=g(Q.value,2),a=e[0],l=e[1];if(""==a||""==l)return z.showToast({message:t("请选择完整时间范围")}),""!=a&&(L.value=1),null;if(B(a).isAfter(B(l)))return z.showToast({message:t("开始日期不能大于结束日期")}),null;$("update:values",Q.value),$("range-change",Q.value),null!=de&&de(Q.value)}else{const e=B(le()).format(q.value);$("update:modelValue",e),$("change",e),null!=de&&de(e)}ne(),ve()}return n(u((()=>P.modelValue)),(e=>{se(e)}),{immediate:!0}),n(u((()=>P.values)),(e=>{oe(e)}),{immediate:!0}),A(new UTSJSONObject({open:ie,close:ve,clear:fe,confirm:me,setValue:se,setValues:oe,setRange:ce})),(t=null,l=null)=>{var u,n,S,f,m,g,b,N;const J=x(r("cl-select-trigger"),e),k=x(r("cl-tag"),F),A=U,B=x(r("cl-text"),Y),D=x(r("cl-picker-view"),M),P=x(r("cl-button"),C),$=x(r("cl-popup"),V);return s(),o(v,null,[a.showTrigger?(s(),c(J,{key:0,pt:{className:null===(u=E.value.trigger)||void 0===u?null:u.className,icon:null===(n=E.value.trigger)||void 0===n?null:n.icon},placeholder:a.placeholder,disabled:a.disabled,focus:null===(S=I.value)||void 0===S?null:S.isOpen,text:ue.value,"arrow-icon":"calendar-line",onClick:l[0]||(l[0]=(e=null)=>ie()),onClear:fe},null,8,["pt","placeholder","disabled","focus","text"])):p("",!0),d($,{ref_key:"popupRef",ref:I,modelValue:pe.value,"onUpdate:modelValue":l[4]||(l[4]=(e=null)=>pe.value=e),title:a.title,pt:{className:null===(f=E.value.popup)||void 0===f?null:f.className,header:null===(m=E.value.popup)||void 0===m?null:m.header,container:null===(g=E.value.popup)||void 0===g?null:g.container,mask:null===(b=E.value.popup)||void 0===b?null:b.mask,draw:null===(N=E.value.popup)||void 0===N?null:N.draw},onClosed:Se},{default:i((()=>[d(A,new UTSJSONObject({class:"cl-select-popup",onTouchmove:l[3]||(l[3]=O((()=>{}),["stop"]))}),{default:i((()=>[a.rangeable?(s(),c(A,new UTSJSONObject({key:0,class:"cl-select-popup__range"}),new UTSJSONObject({default:i((()=>[a.showShortcuts?(s(),c(A,new UTSJSONObject({key:0,class:"cl-select-popup__range-shortcuts"}),new UTSJSONObject({default:i((()=>[(s(!0),o(v,null,_(K.value,((e,a)=>(s(),c(k,new UTSJSONObject({key:a,plain:"",type:G.value==a?"primary":"info",onClick:(t=null)=>function(e,a){G.value=a,Q.value=[...e],se(e[L.value])}(e.value,a)}),new UTSJSONObject({default:i((()=>[h(y(e.label),1)])),_:2}),1032,["type","onClick"])))),128))])),_:1}))):p("",!0),d(A,new UTSJSONObject({class:"cl-select-popup__range-values"}),{default:i((()=>[d(A,new UTSJSONObject({class:w(["cl-select-popup__range-values-start",new UTSJSONObject({"is-dark":T(j),active:0==L.value})]),onClick:l[1]||(l[1]=(e=null)=>ce(0))}),{default:i((()=>[""!=Q.value[0]?(s(),c(B,new UTSJSONObject({key:0,pt:new UTSJSONObject({className:"text-center"})}),new UTSJSONObject({default:i((()=>[h(y(Q.value[0]),1)])),_:1}))):(s(),c(B,new UTSJSONObject({key:1,pt:new UTSJSONObject({className:"text-center -important-text-surface-400"})}),new UTSJSONObject({default:i((()=>[h(y(a.startPlaceholder),1)])),_:1})))])),_:1},8,["class"]),d(B,new UTSJSONObject({pt:new UTSJSONObject({className:"mx-3"})}),{default:i((()=>[h(y(a.rangeSeparator),1)])),_:1}),d(A,new UTSJSONObject({class:w(["cl-select-popup__range-values-end",new UTSJSONObject({"is-dark":T(j),active:1==L.value})]),onClick:l[2]||(l[2]=(e=null)=>ce(1))}),{default:i((()=>[""!=Q.value[1]?(s(),c(B,new UTSJSONObject({key:0,pt:new UTSJSONObject({className:"text-center"})}),new UTSJSONObject({default:i((()=>[h(y(Q.value[1]),1)])),_:1}))):(s(),c(B,new UTSJSONObject({key:1,pt:new UTSJSONObject({className:"text-center -important-text-surface-400"})}),new UTSJSONObject({default:i((()=>[h(y(a.endPlaceholder),1)])),_:1})))])),_:1},8,["class"])])),_:1})])),_:1}))):p("",!0),d(A,new UTSJSONObject({class:"cl-select-popup__picker"}),{default:i((()=>[d(D,new UTSJSONObject({headers:a.headers,value:te.value,columns:ae.value,onChange:re}),null,8,["headers","value","columns"])])),_:1}),d(A,new UTSJSONObject({class:"cl-select-popup__op"}),{default:i((()=>[a.showCancel?(s(),c(P,new UTSJSONObject({key:0,size:"large",text:"",border:"",type:"light",pt:new UTSJSONObject({className:"flex-1 -important-rounded-xl h--bracket-start-80rpx-bracket-end-"}),onClick:ve}),new UTSJSONObject({default:i((()=>[h(y(a.cancelText),1)])),_:1}))):p("",!0),a.showConfirm?(s(),c(P,new UTSJSONObject({key:1,size:"large",pt:new UTSJSONObject({className:"flex-1 -important-rounded-xl h--bracket-start-80rpx-bracket-end-"}),onClick:me}),new UTSJSONObject({default:i((()=>[h(y(a.confirmText),1)])),_:1}))):p("",!0)])),_:1})])),_:1})])),_:1},8,["modelValue","title","pt"])],64)}}})),[["__scopeId","data-v-06f0f202"]]);export{P as _};
