import{_ as e}from"./cl-select-trigger.1oGFq4Uw.js";import{d as l,t,r as a,h as n,X as u,a as o,o as s,l as p,c as r,x as c,e as i,w as d,F as v,Y as f,a7 as m,S as g,N as S,f as _,g as h,T as O,_ as T}from"./index-CQm_J2yh.js";import{r as b,d as y,f as w,c as U}from"./cl-page.uvue_vue_type_script_setup_true_lang.CluByn4i.js";import{_ as N}from"./cl-picker-view.CdDOkD00.js";class j extends UTS.UTSType{static get$UTSMetadata$(){return{kind:2,get fields(){return{trigger:{type:"Unknown",optional:!0},popup:{type:"Unknown",optional:!0}}}}}constructor(e,l=j.get$UTSMetadata$(),t=!1){super(),this.__props__=UTS.UTSType.initProps(e,l,t),this.trigger=this.__props__.trigger,this.popup=this.__props__.popup,delete this.__props__}}const x=U(l(Object.assign({name:"cl-select"},{__name:"cl-select",props:{pt:{type:Object,default:()=>new UTSJSONObject({})},modelValue:{type:[Array,Number,String],default:null},title:{type:String,default:()=>t("请选择")},placeholder:{type:String,default:()=>t("请选择")},options:{type:Array,default:()=>[]},showTrigger:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},columnCount:{type:Number,default:1},splitor:{type:String,default:" - "},confirmText:{type:String,default:()=>t("确定")},showConfirm:{type:Boolean,default:!0},cancelText:{type:String,default:()=>t("取消")},showCancel:{type:Boolean,default:!0}},emits:["update:modelValue","change","changing"],setup(l,t){var U=t.expose,j=t.emit;const x=l,k=j,C=a(null),J=n((()=>f(x.pt))),V=a([]),$=a([]),A=n((()=>{let e=x.options,l=[];for(let t=0;t<x.columnCount;t++){const a=[...e],n=t>=V.value.length?null:V.value[t];let u=UTS.arrayFind(e,(e=>e.value==n));null!=u||m(e)||(u=e[0]),null!=(null==u?null:u.children)&&(e=u.children),l.push(a)}return l})),B=a("");function F(){return 1==x.columnCount?V.value[0]:V.value}function I(e=null){let l;l=null==e?[]:Array.isArray(e)?[...e]:[e];let t=[];for(let a=0;a<x.columnCount;a++){const e=A.value[a];if(a>=l.length)t.push(0),!O(e)&&e.length>0&&!O(e[0])&&l.push(e[0].value);else{let n=e.findIndex((e=>e.value==l[a]));n<0&&(n=0),t.push(n)}}V.value=l,$.value=t,function(){const e=x.modelValue;if(null==e||m(e))B.value="";else{let l;l=1==x.columnCount?[e]:e,B.value=l.map(((e=null,l)=>{var t,a;return null!==(a=null===(t=UTS.arrayFind(A.value[l],(l=>l.value==e)))||void 0===t?null:t.label)&&void 0!==a?a:""})).join(x.splitor)}}()}function z(e){const l=[...$.value];let t=!1;for(let a=0;a<e.length;a++)t?l[a]=0:l[a]!=e[a]&&(l[a]=e[a],t=!0);$.value=l,V.value=l.map(((e,l)=>O(A.value[l][e])?0:A.value[l][e].value)),k("changing",F())}const M=a(!1);let P=null;function R(e=null){M.value=!0,I(x.modelValue),P=e}function X(){M.value=!1}function Y(){B.value="",1==x.columnCount?(k("update:modelValue",null),k("change",null)):(k("update:modelValue",[]),k("change",[]))}function q(){const e=F();k("update:modelValue",e),k("change",e),null!=P&&P(e),X()}return u(n((()=>x.modelValue)),((e=null)=>{I(e)}),{immediate:!0}),U(new UTSJSONObject({open:R,close:X})),(t=null,a=null)=>{var n,u,f,m,O,U,j,x;const k=b(o("cl-select-trigger"),e),V=b(o("cl-picker-view"),N),F=T,I=b(o("cl-button"),y),P=b(o("cl-popup"),w);return s(),p(v,null,[l.showTrigger?(s(),r(k,{key:0,pt:{className:null===(n=J.value.trigger)||void 0===n?null:n.className,icon:null===(u=J.value.trigger)||void 0===u?null:u.icon},placeholder:l.placeholder,disabled:l.disabled,focus:null===(f=C.value)||void 0===f?null:f.isOpen,text:B.value,onOpen:a[0]||(a[0]=(e=null)=>R()),onClear:Y},null,8,["pt","placeholder","disabled","focus","text"])):c("",!0),i(P,{ref_key:"popupRef",ref:C,modelValue:M.value,"onUpdate:modelValue":a[2]||(a[2]=(e=null)=>M.value=e),title:l.title,pt:{className:null===(m=J.value.popup)||void 0===m?null:m.className,header:null===(O=J.value.popup)||void 0===O?null:O.header,container:null===(U=J.value.popup)||void 0===U?null:U.container,mask:null===(j=J.value.popup)||void 0===j?null:j.mask,draw:null===(x=J.value.popup)||void 0===x?null:x.draw}},{default:d((()=>[i(F,new UTSJSONObject({class:"cl-select-popup",onTouchmove:a[1]||(a[1]=g((()=>{}),["stop"]))}),{default:d((()=>[S(t.$slots,"prepend",new UTSJSONObject({}),void 0,!0),i(F,new UTSJSONObject({class:"cl-select-popup__picker"}),{default:d((()=>[i(V,new UTSJSONObject({value:$.value,columns:A.value,onChangeIndex:z}),null,8,["value","columns"])])),_:1}),S(t.$slots,"append",new UTSJSONObject({}),void 0,!0),i(F,new UTSJSONObject({class:"cl-select-popup__op"}),{default:d((()=>[l.showCancel?(s(),r(I,new UTSJSONObject({key:0,size:"large",text:"",border:"",type:"light",pt:new UTSJSONObject({className:"flex-1 -important-rounded-xl h--bracket-start-80rpx-bracket-end-"}),onClick:X}),new UTSJSONObject({default:d((()=>[_(h(l.cancelText),1)])),_:1}))):c("",!0),l.showConfirm?(s(),r(I,new UTSJSONObject({key:1,size:"large",pt:new UTSJSONObject({className:"flex-1 -important-rounded-xl h--bracket-start-80rpx-bracket-end-"}),onClick:q}),new UTSJSONObject({default:d((()=>[_(h(l.confirmText),1)])),_:1}))):c("",!0)])),_:1})])),_:3})])),_:3},8,["modelValue","title","pt"])],64)}}})),[["__scopeId","data-v-00780a6f"]]);export{x as _};
