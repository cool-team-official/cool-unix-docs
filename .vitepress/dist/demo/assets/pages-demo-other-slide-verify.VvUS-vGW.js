import{d as e,t as l,a3 as a,h as s,r as t,X as i,a as u,o as n,c as r,w as c,i as o,Y as d,aL as v,a0 as p,a5 as _,_ as m,n as f,u as g,Z as S,x as y,e as h,p as O,S as b,A as T,f as w,g as U,au as N}from"./index-CNagV5B9.js";import{r as j,a as x,_ as J,c as k,b as z,u as V}from"./cl-page.uvue_vue_type_script_setup_true_lang.Dujw6vu5.js";import{v as F}from"./index.U6ITPUe7.js";import{D as M}from"./item.BgF8i6G3.js";import"./item.uvue_vue_type_style_index_0_scoped_b08ace3b_lang.LX4ndQdB.js";class $ extends UTS.UTSType{static get$UTSMetadata$(){return{kind:2,get fields(){return{className:{type:String,optional:!0},track:{type:"Unknown",optional:!0},image:{type:"Unknown",optional:!0},progress:{type:"Unknown",optional:!0},slider:{type:"Unknown",optional:!0},icon:{type:"Unknown",optional:!0},text:{type:"Unknown",optional:!0},label:{type:"Unknown",optional:!0}}}}}constructor(e,l=$.get$UTSMetadata$(),a=!1){super(),this.__props__=UTS.UTSType.initProps(e,l,a),this.className=this.__props__.className,this.track=this.__props__.track,this.image=this.__props__.image,this.progress=this.__props__.progress,this.slider=this.__props__.slider,this.icon=this.__props__.icon,this.text=this.__props__.text,this.label=this.__props__.label,delete this.__props__}}const B=k(e(Object.assign({name:"cl-slide-verify"},{__name:"cl-slide-verify",props:{pt:{type:Object,default:()=>new UTSJSONObject({})},modelValue:{type:Boolean,default:!1},mode:{type:String,default:"slide"},size:{type:Number,default:40},disabled:{type:Boolean,default:!1},imageUrl:{type:String,default:""},imageSize:{type:[Number,String],default:300},angleThreshold:{type:Number,default:10},text:{type:String,default:""},successText:{type:String,default:()=>l("验证成功")},showFail:{type:Boolean,default:!0},failText:{type:String,default:()=>l("验证失败")}},emits:["update:modelValue","success","fail","change"],setup(e,k){var z=k.expose,V=k.emit;const M=e,$=V,B=a().proxy,X=s((()=>d(M.pt))),L=t(!1),A=t(!1),C=t(!1),D=t(0),I=t(0),K=t(0),P=t(0),R=t(0),Y=t(0),Z=s((()=>A.value?M.successText:C.value?M.failText:""!=M.text?M.text:"image"==M.mode?l("向右滑动转动图片"):l("向右滑动验证"))),q=s((()=>A.value?"check-line":"arrow-right-double-line")),E=s((()=>A.value||C.value?"white":"primary")),G=s((()=>A.value?"success":C.value?"error":L.value?"primary":"info")),H=s((()=>{const e=new UTSJSONObject({});let l=I.value;return l>M.size&&(l+=M.size/2),e.width=l+"px",e})),Q=s((()=>new UTSJSONObject({left:D.value+"px",height:M.size+"px",width:M.size+"px"})));function W(){D.value=0,I.value=0,A.value=!1,C.value=!1,L.value=!1,"image"==M.mode&&(R.value=v(100,180),P.value=R.value)}function ee(){p((()=>{W(),_().in(B).select(".cl-slide-verify").boundingClientRect().exec((e=>{var l;Y.value=null!==(l=e[0].width)&&void 0!==l?l:0}))}))}function le(e){if(M.disabled||A.value||C.value)return null;L.value=!0,K.value=e.touches[0].clientX,F(1)}function ae(e){if(!L.value||M.disabled||A.value||C.value)return null;const l=e.touches[0].clientX-K.value,a=Math.max(0,Math.min(Y.value-M.size,l));if(D.value=a,I.value=a,"image"==M.mode){const e=a/(Y.value-M.size);P.value=R.value+R.value*e*3}$("change",new UTSJSONObject({progress:a/Y.value,angle:P.value}))}function se(){if(!L.value||M.disabled||A.value||C.value)return null;L.value=!1;(function(){if("slide"==M.mode)return D.value/(Y.value-M.size)==1;if("image"==M.mode){const e=P.value%360;return e<=M.angleThreshold||e>=360-M.angleThreshold}return!1})()?(A.value=!0,$("update:modelValue",!0),$("success",new UTSJSONObject({mode:M.mode,progress:D.value/Y.value,angle:P.value}))):(M.showFail?C.value=!0:W(),$("update:modelValue",!1),$("fail",new UTSJSONObject({mode:M.mode,progress:D.value/Y.value,angle:P.value}))),F(1)}return i(s((()=>M.mode)),(()=>{W(),ee()}),{immediate:!0}),i(s((()=>M.imageUrl)),(()=>{"image"==M.mode&&W()})),z(new UTSJSONObject({init:ee,reset:W})),(l=null,a=null)=>{const s=N,t=m,i=j(u("cl-icon"),x),d=j(u("cl-text"),J);return n(),r(t,new UTSJSONObject({class:o(["cl-slide-verify",[new UTSJSONObject({}),new UTSJSONObject({"cl-slide-verify--disabled":e.disabled,"cl-slide-verify--success":A.value,"cl-slide-verify--fail":C.value}),X.value.className]])}),{default:c((()=>{var l,a;return["image"==e.mode&&""!=e.imageUrl?(n(),r(s,{key:0,class:o(["cl-slide-verify__image",[new UTSJSONObject({}),null===(l=X.value.image)||void 0===l?null:l.className]]),src:e.imageUrl,style:f({transform:"rotate(".concat(P.value,"deg)"),height:g(S)(e.imageSize),width:g(S)(e.imageSize)}),mode:"aspectFill"},null,8,["class","src","style"])):y("",!0),h(t,{class:o(["cl-slide-verify__track",[new UTSJSONObject({}),new UTSJSONObject({"cl-slide-verify__track--success":A.value,"cl-slide-verify__track--fail":C.value,"cl-slide-verify__track--dark":g(O)}),null===(a=X.value.track)||void 0===a?null:a.className]]),style:f({height:e.size+"px"})},{default:c((()=>{var e,l,a;return[h(t,{class:o(["cl-slide-verify__progress",[new UTSJSONObject({}),new UTSJSONObject({"cl-slide-verify__progress--success":A.value,"cl-slide-verify__progress--fail":C.value,"no-dragging":!L.value}),null===(e=X.value.progress)||void 0===e?null:e.className]]),style:f(H.value)},null,8,["class","style"]),h(t,{class:o(["cl-slide-verify__slider",[new UTSJSONObject({}),new UTSJSONObject({"cl-slide-verify__slider--active":L.value,"cl-slide-verify__slider--success":A.value,"cl-slide-verify__slider--fail":C.value,"cl-slide-verify__slider--dark":g(O),"no-dragging":!L.value}),null===(l=X.value.slider)||void 0===l?null:l.className]]),style:f(Q.value),onTouchstart:le,onTouchmove:b(ae,["stop","prevent"]),onTouchend:se,onTouchcancel:se},{default:c((()=>{var e;return[h(i,{name:q.value,size:44,color:E.value,pt:{className:g(T)([null===(e=X.value.icon)||void 0===e?null:e.className])}},null,8,["name","color","pt"])]})),_:1},8,["class","style"]),h(t,{class:o(["cl-slide-verify__text",[new UTSJSONObject({}),null===(a=X.value.text)||void 0===a?null:a.className]])},{default:c((()=>{var e;return[h(d,{color:G.value,pt:{className:g(T)([null===(e=X.value.label)||void 0===e?null:e.className])}},{default:c((()=>[w(U(Z.value),1)])),_:1},8,["color","pt"])]})),_:1},8,["class"])]})),_:1},8,["class","style"])]})),_:1},8,["class"])}}})),[["__scopeId","data-v-108669db"]]),X=e({__name:"slide-verify",setup(e){const a=V(),s=t(!1);function i(){a.showToast({message:l("验证通过")})}function o(){a.showToast({message:l("验证失败")})}return(e=null,a=null)=>{const t=j(u("cl-slide-verify"),B),d=m,v=j(u("cl-page"),z);return n(),r(v,null,new UTSJSONObject({default:c((()=>[h(d,new UTSJSONObject({class:"p-3"}),{default:c((()=>[h(g(M),new UTSJSONObject({label:g(l)("基础用法")}),{default:c((()=>[h(t,new UTSJSONObject({modelValue:s.value,"onUpdate:modelValue":a[0]||(a[0]=(e=null)=>s.value=e),onSuccess:i,onFail:o}),null,8,["modelValue"])])),_:1},8,["label"]),h(g(M),new UTSJSONObject({label:g(l)("没有错误提示")}),{default:c((()=>[h(t,new UTSJSONObject({"show-fail":!1}))])),_:1},8,["label"]),h(g(M),new UTSJSONObject({label:g(l)("转动图片")}),{default:c((()=>[h(t,new UTSJSONObject({mode:"image","image-url":"https://unix.cool-js.com/images/demo/avatar.jpg"}))])),_:1},8,["label"])])),_:1})])),_:1}))}}});export{X as default};
