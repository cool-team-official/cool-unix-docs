import{d as e,r as t,h as a,aV as s,t as l,a as n,o as c,c as o,w as r,H as i,I as d,e as u,l as O,m as S,i as m,u as f,p,f as b,g as w,F as j,x as N,O as T,q as U,_ as J}from"./index-CNagV5B9.js";import{s as _,q as h,o as x,t as g,r as v,u as k,_ as y,a as D,d as C,b as z}from"./cl-page.uvue_vue_type_script_setup_true_lang.Dujw6vu5.js";import{_ as V}from"./cl-radio.o2SwpQHv.js";import{_ as q}from"./cl-empty.CDnmE2uK.js";import{_ as P}from"./cl-footer.T69JFkIC.js";import{u as F}from"./pager.CMqKXfAd.js";import"./form.psaMSS8r.js";import"./component.C_1pcFTG.js";const L=e({__name:"address",setup(e){const L=k(),A=F((e=>i(this,void 0,void 0,(function*(){return d({url:"/app/user/address/page",method:"POST",data:e}).catch(((e=null)=>{L.showToast({message:e.message})})).finally((()=>{L.hideLoading()}))})))),E=A.refresh,H=A.list,I=A.loadMore,M=t(0),X=a((()=>H.value.map((e=>{e.isDefault=1==e.isDefault;const t=T(e);return t.isDefault&&(M.value=t.id),t}))));return _((()=>{E(new UTSJSONObject({page:1})).finally((()=>{s()}))})),h((()=>{I()})),x((()=>{L.showLoading(l("加载中")),E(new UTSJSONObject({page:1,size:20})),g((()=>{E(new UTSJSONObject({}))}))})),(e=null,t=null)=>{const a=v(n("cl-text"),y),s=J,i=v(n("cl-radio"),V),T=v(n("cl-icon"),D),_=v(n("cl-empty"),q),h=v(n("cl-button"),C),x=v(n("cl-footer"),P),g=v(n("cl-page"),z);return c(),o(g,null,new UTSJSONObject({default:r((()=>[u(s,new UTSJSONObject({class:"p-3"}),{default:r((()=>[(c(!0),O(j,null,S(X.value,((e,n)=>(c(),o(s,new UTSJSONObject({class:m(["flex flex-col bg-white rounded-2xl p-4 mb-3",new UTSJSONObject({"dark-colon--important-bg-surface-800":f(p),"-important-mb-0":n==X.value.length-1})]),key:e.id}),new UTSJSONObject({default:r((()=>[u(s,new UTSJSONObject({class:"flex flex-col"}),{default:r((()=>[u(a,new UTSJSONObject({color:"info",pt:new UTSJSONObject({className:"-important-text-sm"})}),{default:r((()=>[b(w(e.province)+" "+w(e.city)+" "+w(e.district),1)])),_:2},1024),u(a,new UTSJSONObject({pt:new UTSJSONObject({className:"my-1"})}),{default:r((()=>[b(w(e.address),1)])),_:2},1024),u(s,new UTSJSONObject({class:"flex flex-row"}),{default:r((()=>[u(a,new UTSJSONObject({pt:new UTSJSONObject({className:"-important-text-sm"})}),{default:r((()=>[b(w(e.contact),1)])),_:2},1024),u(a,new UTSJSONObject({color:"info",pt:new UTSJSONObject({className:"ml-3 -important-text-sm"})}),{default:r((()=>[b(w(e.phone),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),u(s,new UTSJSONObject({class:m(["flex flex-row border border-solid border-gray-100 border-b-0 border-l-0 border-r-0 pt-4 mt-4",new UTSJSONObject({"dark-colon--important-border-surface-700":f(p)})])}),{default:r((()=>[u(i,new UTSJSONObject({modelValue:M.value,"onUpdate:modelValue":t[0]||(t[0]=(e=null)=>M.value=e),"active-icon":"checkbox-circle-fill","inactive-icon":"checkbox-blank-circle-line",pt:new UTSJSONObject({className:"max-w--bracket-start-300rpx-bracket-end-",label:new UTSJSONObject({className:"-important-text-sm"}),icon:new UTSJSONObject({size:32})}),value:e.id,onChange:(t=null)=>function(e){X.value.forEach((t=>{t.id==e.id?(t.isDefault=!t.isDefault,t.isDefault||(M.value=0)):t.isDefault=!1})),d({url:"/app/user/address/update",method:"POST",data:new UTSJSONObject({id:e.id,isDefault:e.isDefault})})}(e)}),{default:r((()=>[b(w(e.isDefault?f(l)("已设为默认"):f(l)("设为默认")),1)])),_:2},1032,["modelValue","value","onChange"]),u(s,new UTSJSONObject({class:"flex flex-row items-center justify-center ml-auto",onClick:(t=null)=>{return a=e.id,void L.showConfirm({title:l("提示"),message:l("删除地址后无法恢复，确认要删除该地址吗？"),callback:e=>{"confirm"==e&&d({url:"/app/user/address/delete",method:"POST",data:new UTSJSONObject({ids:[a]})}).then((()=>{L.showToast({message:l("删除成功")}),E(new UTSJSONObject({}))})).catch(((e=null)=>{L.showToast({message:e.message})}))}});var a}}),{default:r((()=>[u(T,new UTSJSONObject({name:"delete-bin-line",size:28})),u(a,new UTSJSONObject({pt:new UTSJSONObject({className:"ml-2 -important-text-sm"})}),{default:r((()=>[b(w(f(l)("删除")),1)])),_:1})])),_:2},1032,["onClick"]),u(s,new UTSJSONObject({class:"flex flex-row items-center justify-center ml-6",onClick:(t=null)=>{return a=e.id,void U.push({path:"/pages/template/shop/address-edit",query:new UTSJSONObject({id:a})});var a}}),{default:r((()=>[u(T,new UTSJSONObject({name:"edit-line",size:28})),u(a,new UTSJSONObject({pt:new UTSJSONObject({className:"ml-2 -important-text-sm"})}),{default:r((()=>[b(w(f(l)("修改")),1)])),_:1})])),_:2},1032,["onClick"])])),_:2},1032,["class"])])),_:2}),1032,["class"])))),128)),0==f(H).length?(c(),o(_,new UTSJSONObject({key:0}))):N("",!0)])),_:1}),u(x,null,{default:r((()=>[u(h,new UTSJSONObject({onClick:t[1]||(t[1]=(e=null)=>{U.to("/pages/template/shop/address-edit")})}),{default:r((()=>[b(w(f(l)("添加地址")),1)])),_:1})])),_:1})])),_:1}))}}});export{L as default};
