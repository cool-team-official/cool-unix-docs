import{d as e,Z as t,c as a,z as l,T as s,U as n,o as i,a as c,w as u,n as o,X as r,u as p,W as v,a4 as _,_ as d,b as m,j as b,k as S,H as h,F as g,q as O,a5 as T,av as N,r as U,t as f,x as w}from"./index-BAeoAK27.js";import{c as y,r as j,b as x}from"./cl-page.uvue_vue_type_script_setup_true_lang.CFvuOJz5.js";import{D as J}from"./item.Dygimnkt.js";import"./item.uvue_vue_type_style_index_0_scoped_f51a3be8_lang.V5eGa8dR.js";class k extends UTS.UTSType{static get$UTSMetadata$(){return{kind:2,get fields(){return{url:{type:String,optional:!1},isActive:{type:Boolean,optional:!1}}}}}constructor(e,t=k.get$UTSMetadata$(),a=!1){super(),this.__props__=UTS.UTSType.initProps(e,t,a),this.url=this.__props__.url,this.isActive=this.__props__.isActive,delete this.__props__}}class A extends UTS.UTSType{static get$UTSMetadata$(){return{kind:2,get fields(){return{className:{type:String,optional:!0},item:{type:"Unknown",optional:!0},itemActive:{type:"Unknown",optional:!0},image:{type:"Unknown",optional:!0},dots:{type:"Unknown",optional:!0},dot:{type:"Unknown",optional:!0},dotActive:{type:"Unknown",optional:!0}}}}}constructor(e,t=A.get$UTSMetadata$(),a=!1){super(),this.__props__=UTS.UTSType.initProps(e,t,a),this.className=this.__props__.className,this.item=this.__props__.item,this.itemActive=this.__props__.itemActive,this.image=this.__props__.image,this.dots=this.__props__.dots,this.dot=this.__props__.dot,this.dotActive=this.__props__.dotActive,delete this.__props__}}const M=y(e(Object.assign({name:"cl-banner"},{__name:"cl-banner",props:{pt:{type:Object,default:()=>new UTSJSONObject({})},list:{type:Array,default:()=>[]},previousMargin:{type:Number,default:0},nextMargin:{type:Number,default:0},autoplay:{type:Boolean,default:!0},interval:{type:Number,default:5e3},showDots:{type:Boolean,default:!0},disableTouch:{type:Boolean,default:!1},height:{type:[Number,String],default:300}},emits:["change","item-tap"],setup(e,U){var f=U.emit;const w=e,y=f,j=t().proxy,x=a((()=>v(w.pt))),J=l(0),A=a((()=>w.list.map(((e,t)=>new k({url:e,isActive:t==J.value}))))),M=l(0),$=l(!1),D=l(0),B=l(0),X=l(0),C=l(0),I=l(0);function F(){if(0==D.value)return null;let e=0;for(let a=0;a<J.value;a++){const t=0==a?0:w.previousMargin,l=a==w.list.length-1?0:w.nextMargin;e+=D.value-t-l}const t=0==J.value?0:w.previousMargin;M.value=-e+t}function P(e){const t=0==e?0:w.previousMargin,a=e==w.list.length-1?0:w.nextMargin;return D.value-t-a}function q(){_().in(j).select(".cl-banner").boundingClientRect(((e=null)=>{var t;D.value=null!==(t=e.width)&&void 0!==t?t:0,function(){const e=D.value-w.previousMargin-w.nextMargin;B.value=e}(),F()})).exec()}let z=0;function H(){0!=z&&(clearInterval(z),z=0)}function R(){if(w.list.length<=1)return null;w.autoplay&&H(),$.value=!0,z=setInterval((()=>{J.value>=w.list.length-1?J.value=0:J.value++}),w.interval)}function W(e){return w.disableTouch||w.list.length<=1?null:(H(),$.value=!1,X.value=e.touches[0].clientX,C.value=Date.now(),void(I.value=M.value))}function Z(e){if(w.list.length<=1||w.disableTouch)return null;const t=e.touches[0].clientX-X.value;M.value=I.value+t}function E(){if(w.list.length<=1)return null;$.value=!0;const e=M.value-I.value,t=Date.now()-C.value,a=Math.abs(e)/t;let l=J.value;const s=P(J.value);(Math.abs(e)>.3*s||a>.3)&&(e>0&&J.value>0?l=J.value-1:e<0&&J.value<w.list.length-1&&(l=J.value+1)),J.value=l,F(),setTimeout((()=>{R()}),300)}return s(J,(e=>{F(),y("change",e)})),n((()=>{q(),R()})),(t=null,a=null)=>{const l=N,s=d;return i(),c(s,new UTSJSONObject({class:o(["cl-banner",[new UTSJSONObject({}),x.value.className]]),style:r({height:p(T)(e.height)}),onTouchstart:W,onTouchmove:Z,onTouchend:E,onTouchcancel:E}),{default:u((()=>{var a;return[m(s,new UTSJSONObject({class:o(["cl-banner__list",new UTSJSONObject({"is-transition":$.value})]),style:r({transform:"translateX(".concat(M.value,"px)")})}),{default:u((()=>[(i(!0),b(g,null,S(A.value,((e,a)=>{var n,p;return i(),c(s,{class:o(["cl-banner__item",[new UTSJSONObject({}),null===(n=x.value.item)||void 0===n?null:n.className,"".concat(e.isActive?"".concat(null===(p=x.value.itemActive)||void 0===p?null:p.className):"")]]),key:a,style:r({width:"".concat(P(a),"px")}),onClick:(e=null)=>function(e){y("item-tap",e)}(a)},{default:u((()=>[h(t.$slots,"default",new UTSJSONObject({item:e,index:a}),(()=>{var t;return[m(l,{src:e.url,mode:"aspectFill",class:o(["cl-banner__item-image",[new UTSJSONObject({}),null===(t=x.value.image)||void 0===t?null:t.className]])},null,8,["src","class"])]}),!0)])),_:2},1032,["class","style","onClick"])})),128))])),_:3},8,["class","style"]),e.showDots?(i(),c(s,{key:0,class:o(["cl-banner__dots",[new UTSJSONObject({}),null===(a=x.value.dots)||void 0===a?null:a.className]])},{default:u((()=>[(i(!0),b(g,null,S(A.value,((e,t)=>{var a,l;return i(),c(s,{class:o(["cl-banner__dots-item",[new UTSJSONObject({}),new UTSJSONObject({"is-active":e.isActive}),null===(a=x.value.dot)||void 0===a?null:a.className,"".concat(e.isActive?"".concat(null===(l=x.value.dotActive)||void 0===l?null:l.className):"")]]),key:t},null,8,["class"])})),128))])),_:1},8,["class"])):O("",!0)]})),_:3},8,["class","style"])}}})),[["__scopeId","data-v-ba0f8960"]]),$=e({__name:"banner",setup(e){const t=l(["https://uni-docs.cool-js.com/demo/pages/demo/static/bg1.png","https://uni-docs.cool-js.com/demo/pages/demo/static/bg2.png","https://uni-docs.cool-js.com/demo/pages/demo/static/bg3.png"]);return(e=null,a=null)=>{const l=j(U("cl-banner"),M),s=d,n=j(U("cl-page"),x);return i(),c(n,null,new UTSJSONObject({default:u((()=>[m(s,new UTSJSONObject({class:"p-3"}),{default:u((()=>[m(p(J),new UTSJSONObject({label:p(f)("基础用法")}),{default:u((()=>[m(l,new UTSJSONObject({list:t.value}),null,8,["list"])])),_:1},8,["label"]),m(p(J),new UTSJSONObject({label:p(f)("禁用手势")}),{default:u((()=>[m(l,new UTSJSONObject({list:t.value,"disable-touch":!0}),null,8,["list"])])),_:1},8,["label"]),m(p(J),new UTSJSONObject({label:p(f)("自定义样式")}),{default:u((()=>[m(l,new UTSJSONObject({list:t.value,pt:new UTSJSONObject({className:"mx--bracket-start--12rpx-bracket-end-",item:new UTSJSONObject({className:p(w)(["scale-y-80 -important-px--bracket-start-12rpx-bracket-end-"])}),itemActive:new UTSJSONObject({className:p(w)(["-important-scale-y-100"])})}),"previous-margin":40,"next-margin":40}),null,8,["list","pt"])])),_:1},8,["label"]),m(p(J),new UTSJSONObject({label:p(f)("自定义样式2")}),{default:u((()=>[m(l,new UTSJSONObject({list:t.value,pt:new UTSJSONObject({className:"mx--bracket-start--12rpx-bracket-end-",item:new UTSJSONObject({className:p(w)(["px--bracket-start-12rpx-bracket-end-"])})}),"next-margin":40}),null,8,["list","pt"])])),_:1},8,["label"])])),_:1})])),_:1}))}}});export{$ as default};
