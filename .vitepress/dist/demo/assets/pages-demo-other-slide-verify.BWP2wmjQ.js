import{d as e,t as l,a3 as a,h as s,r as t,X as i,a as u,o as n,c as r,w as c,i as o,Y as d,aK as v,_ as p,n as _,u as m,Z as f,x as S,e as g,p as y,S as b,A as h,f as O,g as T,at as w,a0 as U,a5 as N}from"./index-CQm_J2yh.js";import{r as j,a as x,_ as J,c as k,b as z,u as V}from"./cl-page.uvue_vue_type_script_setup_true_lang.CluByn4i.js";import{v as F}from"./index.U6ITPUe7.js";import{D as M}from"./item.CC5TQh1y.js";import"./item.uvue_vue_type_style_index_0_scoped_b08ace3b_lang.K1RFQxW-.js";class $ extends UTS.UTSType{static get$UTSMetadata$(){return{kind:2,get fields(){return{className:{type:String,optional:!0},track:{type:"Unknown",optional:!0},image:{type:"Unknown",optional:!0},progress:{type:"Unknown",optional:!0},slider:{type:"Unknown",optional:!0},icon:{type:"Unknown",optional:!0},text:{type:"Unknown",optional:!0},label:{type:"Unknown",optional:!0}}}}}constructor(e,l=$.get$UTSMetadata$(),a=!1){super(),this.__props__=UTS.UTSType.initProps(e,l,a),this.className=this.__props__.className,this.track=this.__props__.track,this.image=this.__props__.image,this.progress=this.__props__.progress,this.slider=this.__props__.slider,this.icon=this.__props__.icon,this.text=this.__props__.text,this.label=this.__props__.label,delete this.__props__}}const B=k(e(Object.assign({name:"cl-slide-verify"},{__name:"cl-slide-verify",props:{pt:{type:Object,default:()=>new UTSJSONObject({})},modelValue:{type:Boolean,default:!1},mode:{type:String,default:"slide"},size:{type:Number,default:40},disabled:{type:Boolean,default:!1},imageUrl:{type:String,default:""},imageSize:{type:[Number,String],default:300},angleThreshold:{type:Number,default:10},text:{type:String,default:""},successText:{type:String,default:()=>l("验证成功")},showFail:{type:Boolean,default:!0},failText:{type:String,default:()=>l("验证失败")}},emits:["update:modelValue","success","fail","change"],setup(e,k){var z=k.expose,V=k.emit;const M=e,$=V,B=a().proxy,X=s((()=>d(M.pt))),K=t(!1),A=t(!1),C=t(!1),D=t(0),I=t(0),P=t(0),R=t(0),Y=t(0),Z=t(0),q=s((()=>A.value?M.successText:C.value?M.failText:""!=M.text?M.text:"image"==M.mode?l("向右滑动转动图片"):l("向右滑动验证"))),E=s((()=>A.value?"check-line":"arrow-right-double-line")),G=s((()=>A.value||C.value?"white":"primary")),H=s((()=>A.value?"success":C.value?"error":K.value?"primary":"info")),L=s((()=>{const e=new UTSJSONObject({});let l=I.value;return l>M.size&&(l+=M.size/2),e.width=l+"px",K.value||(e["transition-duration"]="300ms"),e})),Q=s((()=>{const e=new UTSJSONObject({left:D.value+"px",height:M.size+"px",width:M.size+"px"});return K.value||(e["transition-duration"]="300ms"),e}));function W(){D.value=0,I.value=0,A.value=!1,C.value=!1,K.value=!1,"image"==M.mode&&(Y.value=v(100,180),R.value=Y.value)}function ee(e){if(M.disabled||A.value||C.value)return null;K.value=!0,P.value=e.touches[0].clientX,F(1)}function le(e){if(!K.value||M.disabled||A.value||C.value)return null;const l=e.touches[0].clientX-P.value,a=Math.max(0,Math.min(Z.value-M.size,l));if(D.value=a,I.value=a,"image"==M.mode){const e=a/(Z.value-M.size);R.value=Y.value+Y.value*e*3}$("change",new UTSJSONObject({progress:a/Z.value,angle:R.value}))}function ae(){if(!K.value||M.disabled||A.value||C.value)return null;K.value=!1;(function(){if("slide"==M.mode)return D.value/(Z.value-M.size)==1;if("image"==M.mode){const e=R.value%360;return e<=M.angleThreshold||e>=360-M.angleThreshold}return!1})()?(A.value=!0,$("update:modelValue",!0),$("success",new UTSJSONObject({mode:M.mode,progress:D.value/Z.value,angle:R.value}))):(M.showFail?C.value=!0:W(),$("update:modelValue",!1),$("fail",new UTSJSONObject({mode:M.mode,progress:D.value/Z.value,angle:R.value}))),F(2)}return i(s((()=>M.mode)),(()=>{W(),U((()=>{W(),N().in(B).select(".cl-slide-verify").boundingClientRect().exec((e=>{var l;Z.value=null!==(l=e[0].width)&&void 0!==l?l:0}))}))}),{immediate:!0}),i(s((()=>M.imageUrl)),(()=>{"image"==M.mode&&W()})),z(new UTSJSONObject({reset:W})),(l=null,a=null)=>{const s=w,t=p,i=j(u("cl-icon"),x),d=j(u("cl-text"),J);return n(),r(t,new UTSJSONObject({class:o(["cl-slide-verify",[new UTSJSONObject({}),new UTSJSONObject({"cl-slide-verify--disabled":e.disabled,"cl-slide-verify--success":A.value,"cl-slide-verify--fail":C.value}),X.value.className]])}),{default:c((()=>{var l,a;return["image"==e.mode&&""!=e.imageUrl?(n(),r(s,{key:0,class:o(["cl-slide-verify__image",[new UTSJSONObject({}),null===(l=X.value.image)||void 0===l?null:l.className]]),src:e.imageUrl,style:_({transform:"rotate(".concat(R.value,"deg)"),height:m(f)(e.imageSize),width:m(f)(e.imageSize)}),mode:"aspectFill"},null,8,["class","src","style"])):S("",!0),g(t,{class:o(["cl-slide-verify__track",[new UTSJSONObject({}),new UTSJSONObject({"cl-slide-verify__track--success":A.value,"cl-slide-verify__track--fail":C.value,"cl-slide-verify__track--dark":m(y)}),null===(a=X.value.track)||void 0===a?null:a.className]]),style:_({height:e.size+"px"})},{default:c((()=>{var e,l,a;return[g(t,{class:o(["cl-slide-verify__progress",[new UTSJSONObject({}),new UTSJSONObject({"cl-slide-verify__progress--success":A.value,"cl-slide-verify__progress--fail":C.value}),null===(e=X.value.progress)||void 0===e?null:e.className]]),style:_(L.value)},null,8,["class","style"]),g(t,{class:o(["cl-slide-verify__slider",[new UTSJSONObject({}),new UTSJSONObject({"cl-slide-verify__slider--active":K.value,"cl-slide-verify__slider--success":A.value,"cl-slide-verify__slider--fail":C.value,"cl-slide-verify__slider--dark":m(y)}),null===(l=X.value.slider)||void 0===l?null:l.className]]),style:_(Q.value),onTouchstart:ee,onTouchmove:b(le,["stop","prevent"]),onTouchend:ae,onTouchcancel:ae},{default:c((()=>{var e;return[g(i,{name:E.value,size:44,color:G.value,pt:{className:m(h)([null===(e=X.value.icon)||void 0===e?null:e.className])}},null,8,["name","color","pt"])]})),_:1},8,["class","style"]),g(t,{class:o(["cl-slide-verify__text",[new UTSJSONObject({}),null===(a=X.value.text)||void 0===a?null:a.className]])},{default:c((()=>{var e;return[g(d,{color:H.value,pt:{className:m(h)([null===(e=X.value.label)||void 0===e?null:e.className])}},{default:c((()=>[O(T(q.value),1)])),_:1},8,["color","pt"])]})),_:1},8,["class"])]})),_:1},8,["class","style"])]})),_:1},8,["class"])}}})),[["__scopeId","data-v-b36aa5b7"]]),X=e({__name:"slide-verify",setup(e){const a=V(),s=t(!1);function i(){a.showToast({message:l("验证通过")})}function o(){a.showToast({message:l("验证失败")})}return(e=null,a=null)=>{const t=j(u("cl-slide-verify"),B),d=p,v=j(u("cl-page"),z);return n(),r(v,null,new UTSJSONObject({default:c((()=>[g(d,new UTSJSONObject({class:"p-3"}),{default:c((()=>[g(m(M),new UTSJSONObject({label:m(l)("基础用法")}),{default:c((()=>[g(t,new UTSJSONObject({modelValue:s.value,"onUpdate:modelValue":a[0]||(a[0]=(e=null)=>s.value=e),onSuccess:i,onFail:o}),null,8,["modelValue"])])),_:1},8,["label"]),g(m(M),new UTSJSONObject({label:m(l)("没有错误提示")}),{default:c((()=>[g(t,new UTSJSONObject({"show-fail":!1}))])),_:1},8,["label"]),g(m(M),new UTSJSONObject({label:m(l)("转动图片")}),{default:c((()=>[g(t,new UTSJSONObject({mode:"image","image-url":"https://unix.cool-js.com/images/demo/avatar.jpg"}))])),_:1},8,["label"])])),_:1})])),_:1}))}}});export{X as default};
