import{J as e,d as t,a8 as a,c as l,z as n,T as s,U as i,o as c,j as u,b as r,w as o,n as d,an as p,ao as _,F as h,W as S,_ as v,O,k as b,a as f,u as m,e as T,f as y,g as U,m as w,Z as g,a9 as x,a0 as N,t as j,X as J,a2 as k,q as H,aq as $,r as M,x as V,H as B,av as A}from"./index-BoLJSUaB.js";import{c as C,r as E,a as I}from"./cl-page.uvue_vue_type_script_setup_true_lang.Dheht3lz.js";function z(t){return t.map((t=>e(t)))}function P(t){return t.map((t=>e(t)))}UTS.UTSType;const R=C(t(Object.assign({name:"cl-index-bar"},{__name:"cl-index-bar",props:{pt:{type:Object,default:()=>new UTSJSONObject({})},modelValue:{type:Number,default:0},list:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(e,t){var j=t.emit;const J=e,k=j,H=a().proxy,$=l((()=>S(J.pt))),M=n({height:0,width:0,left:0,top:0}),V=n([]),B=n(!1),A=n(!1),C=n(""),E=n(-1);function I(){g((()=>{setTimeout((()=>{x().in(H).select(".cl-index-bar").boundingClientRect().exec((e=>{if(N(e))return null;M.value=e[0],x().in(H).selectAll(".cl-index-bar__item").boundingClientRect().exec((e=>{if(N(e))return I(),null;V.value=e[0]}))}))}),350)}))}function z(e){var t,a;if(0==V.value.length)return 0;let l=0,n=Number.MAX_VALUE;for(let s=0;s<V.value.length;s++){const i=V.value[s],c=(null!==(t=i.top)&&void 0!==t?t:0)+(null!==(a=i.height)&&void 0!==a?a:0)/2,u=Math.abs(e-c);u<n&&(n=u,l=s)}return l<0?l=0:l>=J.list.length&&(l=J.list.length-1),l}function P(e){E.value=e,C.value=J.list[e]}function R(e){B.value=!0,A.value=!0;P(z(e.touches[0].clientY))}function q(e){if(!B.value)return null;P(z(e.touches[0].clientY))}function F(){B.value=!1,J.modelValue!=E.value&&(k("update:modelValue",E.value),k("change",E.value)),setTimeout((()=>{A.value=!1}),500)}return s(l((()=>J.modelValue)),(e=>{E.value=e}),{immediate:!0}),i((()=>{s(l((()=>J.list)),(()=>{I()}),{immediate:!0})})),(t=null,a=null)=>{const l=w,n=v;return c(),u(h,null,[r(n,new UTSJSONObject({class:d(["cl-index-bar",[new UTSJSONObject({}),$.value.className]])}),{default:o((()=>[r(n,new UTSJSONObject({class:"cl-index-bar__list",onTouchstart:R,onTouchmove:O(q,["stop","prevent"]),onTouchend:F}),{default:o((()=>[(c(!0),u(h,null,b(e.list,((e,t)=>(c(),f(n,new UTSJSONObject({class:"cl-index-bar__item",key:t}),new UTSJSONObject({default:o((()=>[r(n,new UTSJSONObject({class:d(["cl-index-bar__item-inner",new UTSJSONObject({"is-active":E.value==t})])}),{default:o((()=>[r(l,new UTSJSONObject({class:d(["cl-index-bar__item-text",new UTSJSONObject({"dark-colon-text-surface-50":m(T),"is-active":E.value==t||m(T)})])}),{default:o((()=>[y(U(e),1)])),_:2},1032,["class"])])),_:2},1032,["class"])])),_:2}),1024)))),128))])),_:1})])),_:1},8,["class"]),p(r(n,new UTSJSONObject({class:"cl-index-bar__alert"}),{default:o((()=>[r(n,new UTSJSONObject({class:d(["cl-index-bar__alert-icon",new UTSJSONObject({"dark-colon--important-bg-surface-800":m(T)})])}),{default:o((()=>[r(n,new UTSJSONObject({class:d(["cl-index-bar__alert-arrow",new UTSJSONObject({"dark-colon--important-bg-surface-800":m(T)})])}),null,8,["class"]),r(l,new UTSJSONObject({class:d(["cl-index-bar__alert-text",new UTSJSONObject({"dark-colon-text-surface-50":m(T),"dark-colon--important-text-white":m(T)})])}),{default:o((()=>[y(U(C.value),1)])),_:1},8,["class"])])),_:1},8,["class"])])),_:1},512),[[_,A.value]])],64)}}})),[["__scopeId","data-v-d5380a69"]]);UTS.UTSType;const q=C(t({__name:"cl-empty",props:{pt:{type:Object,default:()=>new UTSJSONObject({})},text:{type:String,default:()=>j("暂无数据")},icon:{type:String,default:"comm"},iconSize:{type:[Number,String],default:120},showIcon:{type:Boolean,default:!0},fixed:{type:Boolean,default:!0}},setup(e){const t=e,a=l((()=>S(t.pt)));return(t=null,l=null)=>{const n=$,s=w,i=v;return c(),f(i,new UTSJSONObject({class:d(["cl-empty",[new UTSJSONObject({}),new UTSJSONObject({"cl-empty--fixed":e.fixed}),a.value.className]])}),new UTSJSONObject({default:o((()=>[e.showIcon?(c(),f(n,new UTSJSONObject({key:0,class:"cl-empty__icon",src:"/static/empty/".concat(e.icon,".png"),style:J({height:m(k)(e.iconSize)}),mode:"aspectFit"}),null,8,["src","style"])):H("",!0),e.text?(c(),f(s,new UTSJSONObject({key:1,class:d(["cl-empty__text",new UTSJSONObject({"dark-colon-text-surface-50":m(T),"dark-colon--important-text-surface-100":m(T)})])}),new UTSJSONObject({default:o((()=>[y(U(e.text),1)])),_:1}),8,["class"])):H("",!0)])),_:1}),8,["class"])}}}),[["__scopeId","data-v-3d7c4d9f"]]);class F extends UTS.UTSType{static get$UTSMetadata$(){return{kind:2,get fields(){return{key:{type:String,optional:!1},type:{type:"Unknown",optional:!1},index:{type:Number,optional:!1},top:{type:Number,optional:!1},height:{type:Number,optional:!1},data:{type:"Unknown",optional:!1}}}}}constructor(e,t=F.get$UTSMetadata$(),a=!1){super(),this.__props__=UTS.UTSType.initProps(e,t,a),this.key=this.__props__.key,this.type=this.__props__.type,this.index=this.__props__.index,this.top=this.__props__.top,this.height=this.__props__.height,this.data=this.__props__.data,delete this.__props__}}class X extends UTS.UTSType{static get$UTSMetadata$(){return{kind:2,get fields(){return{index:{type:String,optional:!1},children:{type:UTS.UTSType.withGenerics(Array,["Unknown"]),optional:!1}}}}}constructor(e,t=X.get$UTSMetadata$(),a=!1){super(),this.__props__=UTS.UTSType.initProps(e,t,a),this.index=this.__props__.index,this.children=this.__props__.children,delete this.__props__}}class Y extends UTS.UTSType{static get$UTSMetadata$(){return{kind:2,get fields(){return{className:{type:String,optional:!0},item:{type:"Unknown",optional:!0},indexBar:{type:"Unknown",optional:!0}}}}}constructor(e,t=Y.get$UTSMetadata$(),a=!1){super(),this.__props__=UTS.UTSType.initProps(e,t,a),this.className=this.__props__.className,this.item=this.__props__.item,this.indexBar=this.__props__.indexBar,delete this.__props__}}const G=C(t(Object.assign({name:"cl-list-view"},{__name:"cl-list-view",props:{pt:{type:Object,default:()=>new UTSJSONObject({})},data:{type:Array,default:()=>[]},itemHeight:{type:Number,default:50},headerHeight:{type:Number,default:32},topHeight:{type:Number,default:0},bottomHeight:{type:Number,default:0},bufferSize:{type:Number,default:15},virtual:{type:Boolean,default:!0}},emits:["item-tap"],setup(e,t){var p=t.emit;const _=e,O=p,w=a().proxy,g=l((()=>S(_.pt))),j=n(0),k=l((()=>N(_.data))),$=l((()=>_.data.every((e=>null!=e.index))&&!k.value)),C=l((()=>{const e=[];return _.data.forEach((t=>{var a;const l=e.findIndex((e=>e.index==t.index));-1!=l?e[l].children.push(t):e.push(new X({index:null!==(a=t.index)&&void 0!==a?a:"",children:[t]}))})),e})),z=l((()=>C.value.map((e=>e.index)))),P=l((()=>{const e=[];let t=_.topHeight,a=0;return C.value.forEach(((l,n)=>{""!=l.index&&(e.push(new F({key:"header-".concat(n),type:"header",index:a++,top:t,height:_.headerHeight,data:{label:l.index,index:l.index}})),t+=_.headerHeight),l.children.forEach(((l,s)=>{e.push(new F({key:"item-".concat(n,"-").concat(s),type:"item",index:a++,top:t,height:_.itemHeight,data:l})),t+=_.itemHeight}))})),e})),Y=l((()=>P.value.reduce(((e,t)=>e+t.height),0)+_.topHeight+_.bottomHeight)),G=n(0),L=n(0),W=n(0),Z=l((()=>{if(N(P.value))return[];if(!_.virtual)return P.value;const e=_.bufferSize*_.itemHeight,t=G.value-e,a=G.value+W.value+e,l=[];let n=0,s=P.value.length-1;for(;n<s;){const e=Math.floor((n+s)/2),a=P.value[e];a.top+a.height<=t?n=e+1:s=e}for(let i=n;i<P.value.length;i++){const e=P.value[i];if(e.top>=a)break;e.top+e.height>t&&l.push(e)}return l})),D=l((()=>N(Z.value)?0:_.virtual?Z.value[0].top:0)),K=l((()=>{if(N(Z.value))return 0;if(!_.virtual)return 0;const e=Z.value[Z.value.length-1];return Y.value-(e.top+e.height)})),Q=n([]);let ee=!1;function te(e){if(G.value=Math.floor(e.detail.scrollTop),ee)return null;Q.value.forEach(((e,t)=>{G.value>=e&&(j.value=t)}))}function ae(e){ee=!0,L.value=Q.value[e],setTimeout((()=>{ee=!1}),300)}return i((()=>{setTimeout((()=>{x().in(w).select(".cl-list-view__scroller").boundingClientRect().exec((e=>{var t;if(N(e))return null;W.value=null!==(t=e[0].height)&&void 0!==t?t:0}))}),100),s(l((()=>_.data)),(()=>{!function(){const e=[];let t=0;C.value.forEach((a=>{e.push(t),t+=_.headerHeight+a.children.length*_.itemHeight})),Q.value=e}()}),{immediate:!0})})),(t=null,a=null)=>{const l=E(M("cl-index-bar"),R),n=v,s=E(M("cl-text"),I),i=E(M("cl-empty"),q),p=A;return c(),f(n,new UTSJSONObject({class:"cl-list-view"}),{default:o((()=>{var _;return[$.value?(c(),f(l,{key:0,modelValue:j.value,"onUpdate:modelValue":a[0]||(a[0]=(e=null)=>j.value=e),list:z.value,pt:{className:m(V)([null===(_=g.value.indexBar)||void 0===_?null:_.className])},onChange:ae},null,8,["modelValue","list","pt"])):H("",!0),r(p,new UTSJSONObject({class:"cl-list-view__scroller","scroll-top":L.value,"show-scrollbar":!1,direction:"vertical",onScroll:te}),{default:o((()=>[r(n,new UTSJSONObject({class:"cl-list-view__virtual-list",style:J({height:Y.value+"px"})}),{default:o((()=>[r(n,new UTSJSONObject({class:"cl-list-view__spacer-top",style:J({height:D.value+"px"})}),{default:o((()=>[B(t.$slots,"top",new UTSJSONObject({}),void 0,!0)])),_:3},8,["style"]),(c(!0),u(h,null,b(Z.value,(a=>(c(),f(n,new UTSJSONObject({key:a.key,class:"cl-list-view__virtual-item"}),{default:o((()=>{var l;return["header"==a.type?(c(),f(n,new UTSJSONObject({key:0,class:d(["cl-list-view__header",[new UTSJSONObject({}),new UTSJSONObject({"is-dark":m(T)})]]),style:J({height:e.headerHeight+"px"})}),new UTSJSONObject({default:o((()=>[B(t.$slots,"header",new UTSJSONObject({index:a.data.index}),(()=>[r(s,null,{default:o((()=>[y(U(a.data.label),1)])),_:2},1024)]),!0)])),_:2}),1032,["class","style"])):(c(),f(n,{key:1,class:d(["cl-list-view__item",[new UTSJSONObject({}),new UTSJSONObject({"is-dark":m(T)}),null===(l=g.value.item)||void 0===l?null:l.className]]),"hover-class":m(V)([[m(T),"-important-bg-surface-800","-important-bg-surface-50"]]),"hover-stay-time":50,style:J({height:e.itemHeight+"px"}),onClick:(e=null)=>function(e){O("item-tap",e.data)}(a)},new UTSJSONObject({default:o((()=>[B(t.$slots,"item",new UTSJSONObject({data:a.data,item:a}),(()=>[r(n,new UTSJSONObject({class:"cl-list-view__item-inner"}),{default:o((()=>[r(s,null,{default:o((()=>[y(U(a.data.label),1)])),_:2},1024)])),_:2},1024)]),!0)])),_:2}),1032,["class","hover-class","style","onClick"]))]})),_:2},1024)))),128)),r(n,new UTSJSONObject({class:"cl-list-view__spacer-bottom",style:J({height:K.value+"px"})}),{default:o((()=>[B(t.$slots,"bottom",new UTSJSONObject({}),void 0,!0)])),_:3},8,["style"])])),_:3},8,["style"]),k.value?(c(),f(i,new UTSJSONObject({key:0,fixed:!1}))):H("",!0)])),_:3},8,["scroll-top"]),$.value?(c(),f(n,new UTSJSONObject({key:1,class:d(["cl-list-view__index",[new UTSJSONObject({}),new UTSJSONObject({"is-dark":m(T)})]]),style:J({height:e.headerHeight+"px"})}),new UTSJSONObject({default:o((()=>[B(t.$slots,"index",new UTSJSONObject({index:z.value[j.value]}),(()=>[r(s,null,{default:o((()=>[y(U(z.value[j.value]),1)])),_:1})]),!0)])),_:3}),8,["class","style"])):H("",!0)]})),_:3})}}})),[["__scopeId","data-v-42fd5952"]]);export{G as _,z as a,P as u};
