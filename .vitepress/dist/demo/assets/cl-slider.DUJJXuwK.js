import{d as e,a3 as a,h as t,r as l,X as s,a4 as n,a as u,o as i,c as r,w as c,i as o,Y as m,a5 as p,_ as d,e as v,n as _,x as h,l as S,F as b,S as f,N as g,u as y,A as x,f as N,g as T,a6 as O,H as U,a0 as w}from"./index-CNagV5B9.js";import{r as k,_ as M,c as j}from"./cl-page.uvue_vue_type_script_setup_true_lang.Dujw6vu5.js";import{u as J}from"./form.psaMSS8r.js";class $ extends UTS.UTSType{static get$UTSMetadata$(){return{kind:2,get fields(){return{className:{type:String,optional:!0},track:{type:"Unknown",optional:!0},progress:{type:"Unknown",optional:!0},thumb:{type:"Unknown",optional:!0},value:{type:"Unknown",optional:!0}}}}}constructor(e,a=$.get$UTSMetadata$(),t=!1){super(),this.__props__=UTS.UTSType.initProps(e,a,t),this.className=this.__props__.className,this.track=this.__props__.track,this.progress=this.__props__.progress,this.thumb=this.__props__.thumb,this.value=this.__props__.value,delete this.__props__}}class V extends UTS.UTSType{static get$UTSMetadata$(){return{kind:2,get fields(){return{min:{type:Number,optional:!1},max:{type:Number,optional:!1}}}}}constructor(e,a=V.get$UTSMetadata$(),t=!1){super(),this.__props__=UTS.UTSType.initProps(e,a,t),this.min=this.__props__.min,this.max=this.__props__.max,delete this.__props__}}const z=j(e(Object.assign({name:"cl-slider"},{__name:"cl-slider",props:{pt:{type:Object,default:()=>new UTSJSONObject({})},modelValue:{type:Number,default:0},values:{type:Array,default:()=>[0,0]},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},disabled:{type:Boolean,default:!1},blockSize:{type:Number,default:40},trackHeight:{type:Number,default:8},showValue:{type:Boolean,default:!1},range:{type:Boolean,default:!1}},emits:["update:modelValue","update:values","change","changing"],setup(e,j){var $=j.emit;const z=e,P=$,B=a().proxy,H=t((()=>m(z.pt))),X=J().disabled,A=t((()=>z.disabled||X.value)),C=l(z.modelValue),F=l([...z.values]),I=l(0),R=l(0),Y=l(0),q=t((()=>z.range?0:(C.value-z.min)/(z.max-z.min)*100)),D=t((()=>{if(!z.range)return new V({min:0,max:0});const e=F.value,a=z.max-z.min,t=(e[0]-z.min)/a*100,l=(e[1]-z.min)/a*100;return new V({min:t,max:l})})),E=t((()=>{const e=new UTSJSONObject({});if(z.range){const a=D.value,t=a.min,l=a.max;e.left="".concat(t,"%"),e.width="".concat(l-t,"%")}else e.width="".concat(q.value,"%");return e}));function G(e){const a=new UTSJSONObject({}),t=I.value-O(z.blockSize)+1,l=e/100*t,s=Math.max(0,Math.min(t,l));return a.left="".concat(s,"px"),a.width="".concat(O(z.blockSize),"px"),a.height="".concat(O(z.blockSize),"px"),a}const K=t((()=>G(q.value))),L=t((()=>G(D.value.min))),Q=t((()=>G(D.value.max))),W=t((()=>{if(z.range){const e=F.value;return"".concat(e[0]," - ").concat(e[1])}return"".concat(C.value)}));function Z(){return new Promise((e=>{p().in(B).select(".cl-slider__track").boundingClientRect(((a=null)=>{var t,l;I.value=null!==(t=a.width)&&void 0!==t?t:0,R.value=null!==(l=a.left)&&void 0!==l?l:0,e()})).exec()}))}function ee(e){if(0==I.value)return z.min;const a=e-R.value,t=Math.max(0,Math.min(1,a/I.value)),l=z.max-z.min;let s=z.min+t*l;return z.step>0&&(s=Math.round((s-z.min)/z.step)*z.step+z.min),Math.max(z.min,Math.min(z.max,s))}function ae(e){if(z.range){const a=e,t=F.value;a[0]>a[1]&&(Y.value=1-Y.value);const l=[Math.min(a[0],a[1]),Math.max(a[0],a[1])];UTS.JSON.stringify(t)!==UTS.JSON.stringify(l)&&(F.value=l,P("update:values",l),P("changing",l))}else{const a=e;C.value!==a&&(C.value=a,P("update:modelValue",a),P("changing",a))}}function te(e){return U(this,void 0,void 0,(function*(){if(A.value)return Promise.resolve(null);yield Z(),w((()=>{const a=e.touches[0].clientX,t=ee(a);if(z.range){Y.value=function(e){if(!z.range)return 0;const a=F.value,t=ee(e);return Math.abs(t-a[0])<=Math.abs(t-a[1])?0:1}(a);const e=[...F.value];e[Y.value]=t,ae(e)}else ae(t)}))}))}function le(e){if(A.value)return null;const a=ee(e.touches[0].clientX);if(z.range){const e=[...F.value];e[Y.value]=a,ae(e)}else ae(a)}function se(){if(A.value)return null;z.range?P("change",F.value):P("change",C.value)}return s(t((()=>z.modelValue)),(e=>{e!==C.value&&(C.value=Math.max(z.min,Math.min(z.max,e)))}),{immediate:!0}),s(t((()=>z.values)),(e=>{F.value=e.map((e=>Math.max(z.min,Math.min(z.max,e))))}),{immediate:!0}),s(t((()=>z.max)),(e=>{if(z.range){const a=F.value;(a[0]>e||a[1]>e)&&ae([Math.min(a[0],e),Math.min(a[1],e)])}else{C.value>e&&ae(e)}}),{immediate:!0}),s(t((()=>z.min)),(e=>{if(z.range){const a=F.value;(a[0]<e||a[1]<e)&&ae([Math.max(a[0],e),Math.max(a[1],e)])}else{C.value<e&&ae(e)}}),{immediate:!0}),n((()=>{s(t((()=>[z.showValue])),(()=>{w((()=>{Z()}))})),Z()})),(a=null,t=null)=>{const l=d,s=k(u("cl-text"),M);return i(),r(l,new UTSJSONObject({class:o(["cl-slider",[new UTSJSONObject({}),new UTSJSONObject({"cl-slider--disabled":A.value}),H.value.className]])}),{default:c((()=>[v(l,new UTSJSONObject({class:"cl-slider__inner",style:_({height:e.blockSize+8+"rpx"})}),{default:c((()=>{var a,t,s,n;return[v(l,{class:o(["cl-slider__track",[new UTSJSONObject({}),null===(a=H.value.track)||void 0===a?null:a.className]]),style:_({height:e.trackHeight+"rpx"})},{default:c((()=>{var e;return[v(l,{class:o(["cl-slider__progress",[new UTSJSONObject({}),null===(e=H.value.progress)||void 0===e?null:e.className]]),style:_(E.value)},null,8,["class","style"])]})),_:1},8,["class","style"]),e.range?h("",!0):(i(),r(l,{key:0,class:o(["cl-slider__thumb",[new UTSJSONObject({}),null===(t=H.value.thumb)||void 0===t?null:t.className]]),style:_(K.value)},null,8,["class","style"])),e.range?(i(),S(b,new UTSJSONObject({key:1}),[v(l,{class:o(["cl-slider__thumb cl-slider__thumb--min",[new UTSJSONObject({}),null===(s=H.value.thumb)||void 0===s?null:s.className]]),style:_(L.value)},null,8,["class","style"]),v(l,{class:o(["cl-slider__thumb cl-slider__thumb--max",[new UTSJSONObject({}),null===(n=H.value.thumb)||void 0===n?null:n.className]]),style:_(Q.value)},null,8,["class","style"])],64)):h("",!0),v(l,new UTSJSONObject({class:"cl-slider__picker",style:_({height:1.5*e.blockSize+"rpx"}),onTouchstart:f(te,["prevent"]),onTouchmove:f(le,["prevent"]),onTouchend:se,onTouchcancel:se}),null,8,["style"])]})),_:1},8,["style"]),g(a.$slots,"value",new UTSJSONObject({value:W.value}),(()=>{var a;return[e.showValue?(i(),r(s,{key:0,pt:{className:y(x)(["text-center w--bracket-start-100rpx-bracket-end-",null===(a=H.value.value)||void 0===a?null:a.className])}},new UTSJSONObject({default:c((()=>[N(T(W.value),1)])),_:1}),8,["pt"])):h("",!0)]}),!0)])),_:3},8,["class"])}}})),[["__scopeId","data-v-ad9e354d"]]);export{z as _};
