import{r as s,H as i,K as t,h as a,O as e}from"./index-CNagV5B9.js";import{a as h}from"./component.C_1pcFTG.js";class l{constructor(l){this.page=1,this.size=20,this.total=0,this.list=s([]),this.loading=s(!1),this.refreshing=s(!1),this.finished=s(!1),this.params={},this.cb=null,this.refresh=s=>i(this,void 0,void 0,(function*(){return new Promise(((i,a)=>{this.params=t(this.params,s);const h=Object.assign({page:this.page,size:this.size},this.params);this.loading.value=!0,this.cb(h).then((s=>{const t=e(s),a=t.list,l=t.pagination;this.page=l.page,this.size=l.size,this.total=l.total,1==h.page?this.list.value=[...a]:this.list.value.push(...a),this.finished.value=this.list.value.length>=this.total,i(s)})).catch((s=>{a(s)})).finally((()=>{this.loading.value=!1}))}))})),this.loadMore=()=>{this.loading.value||this.finished.value||this.refresh({page:this.page+1})},this.listView=a((()=>h(this.list.value))),this.cb=l}done(){this.loading.value=!1}clear(){this.list.value=[],this.finished.value=!1,this.refreshing.value=!1,this.loading.value=!1}}const n=s=>new l(s);export{n as u};
